import{_ as c,r as t,o as d,c as p,d as s,e as l,b as o,a as h,w as i,f as k}from"./app-Bz1lqDsY.js";const B={},y=s("p",null,"Apache POI 是一个流行的 Java 库，用于处理 Microsoft Office 格式文件，包括 Excel、Word 和 PowerPoint。它提供了丰富的 API，可以创建、读取和修改各种类型的 Office 文档。",-1),E={href:"https://poi.apache.org/",target:"_blank",rel:"noopener noreferrer"},A=s("p",null,"优点：",-1),F=s("ul",null,[s("li",null,"功能强大：支持处理复杂的 Excel 文件，包括单元格、样式、图表等内容。"),s("li",null,"稳定性高：作为一个成熟的开源项目，得到广泛支持和持续维护。"),s("li",null,"灵活性：可以满足各种定制化需求，可以实现复杂的 Excel 处理功能。")],-1),u=s("p",null,"缺点：",-1),C=s("ul",null,[s("li",null,"性能相对较低：在处理大量数据时，性能可能受到一定影响。")],-1),b=s("p",null,"参考",-1),m={href:"https://github.com/ZhangZiSheng001/poi-demo",target:"_blank",rel:"noopener noreferrer"},v=s("h2",{id:"引入依赖",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#引入依赖"},[s("span",null,"引入依赖")])],-1),D=s("div",{class:"language-xml line-numbers-mode","data-ext":"xml","data-title":"xml"},[s("pre",{class:"shiki shiki-themes github-light one-dark-pro",style:{"background-color":"#fff","--shiki-dark-bg":"#282c34",color:"#24292e","--shiki-dark":"#abb2bf"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D","--shiki-dark":"#7F848E","font-style":"inherit","--shiki-dark-font-style":"italic"}},"<!-- xls 03 -->")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"<"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"dependency"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"  <"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"groupId"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">org.apache.poi</"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"groupId"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"  <"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"artifactId"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">poi</"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"artifactId"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"  <"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"version"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">3.9</"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"version"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"</"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"dependency"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D","--shiki-dark":"#7F848E","font-style":"inherit","--shiki-dark-font-style":"italic"}},"<!--日期-->")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"<"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"dependency"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"    <"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"groupId"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">joda-time</"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"groupId"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"    <"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"artifactId"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">joda-time</"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"artifactId"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"    <"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"version"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">2.10.10</"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"version"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"</"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"dependency"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">")]),l(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),f=s("div",{class:"language-xml line-numbers-mode","data-ext":"xml","data-title":"xml"},[s("pre",{class:"shiki shiki-themes github-light one-dark-pro",style:{"background-color":"#fff","--shiki-dark-bg":"#282c34",color:"#24292e","--shiki-dark":"#abb2bf"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D","--shiki-dark":"#7F848E","font-style":"inherit","--shiki-dark-font-style":"italic"}},"<!-- xlsx 07 -->")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"<"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"dependency"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"  <"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"groupId"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">org.apache.poi</"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"groupId"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"  <"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"artifactId"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">poi-ooxml</"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"artifactId"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"  <"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"version"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">3.9</"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"version"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"</"),s("span",{style:{color:"#22863A","--shiki-dark":"#E06C75"}},"dependency"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},">")]),l(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),S=k('<h2 id="版本对比" tabindex="-1"><a class="header-anchor" href="#版本对比"><span>版本对比</span></a></h2><ul><li>HSSFWorkbook <ul><li>03 版本，最大 65536 行</li><li>主要使用 HSSFWorkbook、HSSFSheet、HSSFRow、HSSFCell 等对象来操作 Excel 文件</li></ul></li><li>XSSFWorkbook <ul><li>07 版本，没有行限制，但是相对慢</li><li>主要使用 XSSFWorkbook、XSSFSheet、XSSFRow、XSSFCell 等对象来操作 Excel 文件</li></ul></li><li>SXSSFWorkbook <ul><li>没有行限制，写数据快，占用内存少 <ul><li>实现 “BigGridDemo” 策略的流式版本，允许写入大文件而不耗尽内存，因为任何时候只有可配置的行部分被保存在内存中</li><li>👆 请注意，依然可能会消耗大量内存，这些内存基于正在使用的功能，例如合并区域、注释。。。仍然只存储在内存中，因此如果广泛使用，可能需要大量内存</li></ul></li></ul></li></ul><h2 id="写-excel" tabindex="-1"><a class="header-anchor" href="#写-excel"><span>写 excel</span></a></h2>',3),x=s("div",{class:"language-java line-numbers-mode","data-ext":"java","data-title":"java"},[s("pre",{class:"shiki shiki-themes github-light one-dark-pro",style:{"background-color":"#fff","--shiki-dark-bg":"#282c34",color:"#24292e","--shiki-dark":"#abb2bf"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}},"public"),s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}}," class"),s("span",{style:{color:"#6F42C1","--shiki-dark":"#E5C07B"}}," AppTest")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"    String"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," filepath"),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"="),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}},'"E:'),s("span",{style:{color:"#005CC5","--shiki-dark":"#56B6C2"}},"\\\\"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}},"xiezhrspace"),s("span",{style:{color:"#005CC5","--shiki-dark":"#56B6C2"}},"\\\\"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}},"excel-demo"),s("span",{style:{color:"#005CC5","--shiki-dark":"#56B6C2"}},"\\\\"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}},"fileoutput"),s("span",{style:{color:"#005CC5","--shiki-dark":"#56B6C2"}},"\\\\"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}},'"'),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"    @"),s("span",{style:{color:"#D73A49","--shiki-dark":"#E5C07B"}},"Test")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}},"    public"),s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}}," void"),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}}," poiexcel03Test"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"()"),s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}}," throws"),s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"  Exception"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D","--shiki-dark":"#7F848E","font-style":"inherit","--shiki-dark-font-style":"italic"}},"        //1、创建一个工作簿")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"        Workbook"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," workbook"),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}}," ="),s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}}," new"),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}}," HSSFWorkbook"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D","--shiki-dark":"#7F848E","font-style":"inherit","--shiki-dark-font-style":"italic"}},"        //2、创建一个工作表")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"        Sheet"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," sheet"),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}}," ="),s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}}," workbook"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"."),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"createSheet"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"("),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}},'"第一个工作表"'),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},");")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D","--shiki-dark":"#7F848E","font-style":"inherit","--shiki-dark-font-style":"italic"}},"        //3、创建一行")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D","--shiki-dark":"#7F848E","font-style":"inherit","--shiki-dark-font-style":"italic"}},"        //3.1 创建第一行")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"        Row"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," row1"),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}}," ="),s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}}," sheet"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"."),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"createRow"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"("),s("span",{style:{color:"#005CC5","--shiki-dark":"#D19A66"}},"0"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},");")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D","--shiki-dark":"#7F848E","font-style":"inherit","--shiki-dark-font-style":"italic"}},"        //4 创建一个单元格")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D","--shiki-dark":"#7F848E","font-style":"inherit","--shiki-dark-font-style":"italic"}},"        //4.1 创建第一行第一个单元格")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"        Cell"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," cell11"),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}}," ="),s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}}," row1"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"."),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"createCell"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"("),s("span",{style:{color:"#005CC5","--shiki-dark":"#D19A66"}},"0"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},");")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D","--shiki-dark":"#7F848E","font-style":"inherit","--shiki-dark-font-style":"italic"}},"        // 5 设置单元格的值")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D","--shiki-dark":"#7F848E","font-style":"inherit","--shiki-dark-font-style":"italic"}},"        //5.1 设置第一行第一个单元格")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"        cell11"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"."),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"setCellValue"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"("),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}},'"Hello World"'),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},");")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"        FileOutputStream"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," fileOutputStream"),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}}," ="),s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}}," new"),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}}," FileOutputStream"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"(filepath "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"+"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}},' "poiexcel03.xls"'),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"        workbook"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"."),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"write"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"(fileOutputStream);")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"        fileOutputStream"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"."),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"close"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"        workbook"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"."),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"close"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"    }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"}")]),l(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),g=s("p",null,[l("07 版本操作与 03 版本操作基本没什么变化，我们只需将 03 版本代码中 "),s("code",null,"new HSSFWorkbook()"),l(" 修改成 "),s("code",null,"new XSSFWorkbook()"),l(" 即可")],-1),_=s("div",{class:"language-java line-numbers-mode","data-ext":"java","data-title":"java"},[s("pre",{class:"shiki shiki-themes github-light one-dark-pro",style:{"background-color":"#fff","--shiki-dark-bg":"#282c34",color:"#24292e","--shiki-dark":"#abb2bf"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}}," Workbook"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," workbook "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"="),s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}}," new"),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}}," XSSFWorkbook"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}},"()"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}}," ..."),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}},"省略")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}}," FileOutputStream"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," fileOutputStream "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"="),s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}}," new"),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}}," FileOutputStream"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}},"(filepath "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"+"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}},' "poiexcel07.xlsx"'),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}},")"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},";")]),l(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),w=s("h2",{id:"写-excel-大文件",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#写-excel-大文件"},[s("span",null,"写 excel （大文件）")])],-1),O=s("p",null,"根据记录时间，耗时：1.663 秒",-1),I=s("div",{class:"hint-container warning"},[s("p",{class:"hint-container-title"},"注意"),s("p",null,[l("如果 03 版本写入数据行数超过 65536 行会报错误： "),s("code",null,"java.lang.IllegalArgumentException: Invalid row number (65536) outside allowable range (0..65535)")])],-1),W=s("div",{class:"language-java line-numbers-mode","data-ext":"java","data-title":"java"},[s("pre",{class:"shiki shiki-themes github-light one-dark-pro",style:{"background-color":"#fff","--shiki-dark-bg":"#282c34",color:"#24292e","--shiki-dark":"#abb2bf"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"@"),s("span",{style:{color:"#D73A49","--shiki-dark":"#E5C07B"}},"Test")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}},"public"),s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}}," void"),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}}," testBigDateExcelTest"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}},"() throws Exception {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"    Workbook"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," workbook "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"="),s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}}," new"),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}}," HSSFWorkbook"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}},"()"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"    Sheet"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," sheet "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"="),s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}}," workbook"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"."),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"createSheet"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"("),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}},'"大文件导出测试"'),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},");")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}},"    long"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," begin "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"="),s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}}," System"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"."),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"currentTimeMillis"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"();")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}},"    for"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," ("),s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}},"int"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," rowNum "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"="),s("span",{style:{color:"#005CC5","--shiki-dark":"#D19A66"}}," 0"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},";"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," rowNum "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"<"),s("span",{style:{color:"#005CC5","--shiki-dark":"#D19A66"}},"65536"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}}," ;"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," rowNum"),s("span",{style:{color:"#D73A49","--shiki-dark":"#ABB2BF"}},"++"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}},") {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"        Row"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," row "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"="),s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}}," sheet"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"."),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"createRow"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"(rowNum);")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}},"        for"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," ("),s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}},"int"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," cellNum "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"="),s("span",{style:{color:"#005CC5","--shiki-dark":"#D19A66"}}," 0"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},";"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," cellNum "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"<"),s("span",{style:{color:"#005CC5","--shiki-dark":"#D19A66"}}," 10"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}}," ;"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," cellNum"),s("span",{style:{color:"#D73A49","--shiki-dark":"#ABB2BF"}},"++"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}},") {")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"            Cell"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," cell "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"="),s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}}," row"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"."),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"createCell"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"(cellNum);")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"            cell"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"."),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"setCellValue"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"("),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}},'"("'),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"+"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"(rowNum"),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"+"),s("span",{style:{color:"#005CC5","--shiki-dark":"#D19A66"}},"1"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},") "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"+"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}},' ","'),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}}," +"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}}," (cellNum"),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"+"),s("span",{style:{color:"#005CC5","--shiki-dark":"#D19A66"}},"1"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},")"),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"+"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}},'")"'),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}},"        }")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}},"    }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"    FileOutputStream"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," fileOutputStream "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"="),s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}}," new"),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}}," FileOutputStream"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}},"(filepath "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"+"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}},' "03版本批量写入.xls"'),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}},")"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},";")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"    workbook"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"."),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"write"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"(fileOutputStream);")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"    fileOutputStream"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"."),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"close"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"    workbook"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"."),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"close"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"();")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}},"    long"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," end "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"="),s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}}," System"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"."),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"currentTimeMillis"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"();")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"    System"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"."),s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"out"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"."),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"println"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"("),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}},'"耗时："'),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"+"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"("),s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}},"double"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},")(end"),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"-"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},"begin)"),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"/"),s("span",{style:{color:"#005CC5","--shiki-dark":"#D19A66"}},"1000"),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"+"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}},'"秒"'),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},");")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}},"}")]),l(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),j=s("p",null,"由于 07 及以上版本，没有限制行数，但写入数据时耗时相比较长。共耗时：10.959 秒",-1),P=s("div",{class:"language-java line-numbers-mode","data-ext":"java","data-title":"java"},[s("pre",{class:"shiki shiki-themes github-light one-dark-pro",style:{"background-color":"#fff","--shiki-dark-bg":"#282c34",color:"#24292e","--shiki-dark":"#abb2bf"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"Workbook"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," workbook "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"="),s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}}," new"),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}}," XSSFWorkbook"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}},"()"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},";"),s("span",{style:{color:"#6A737D","--shiki-dark":"#7F848E","font-style":"inherit","--shiki-dark-font-style":"italic"}}," // 将 new HSSFWorkbook() 修改成 new XSSFWorkbook() 即可")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}}," ..."),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}},"省略")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E","--shiki-dark":"#E5C07B"}},"FileOutputStream"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}}," fileOutputStream "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"="),s("span",{style:{color:"#D73A49","--shiki-dark":"#C678DD"}}," new"),s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}}," FileOutputStream"),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}},"(filepath "),s("span",{style:{color:"#D73A49","--shiki-dark":"#56B6C2"}},"+"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}},' "07版本批量写入.xlsx"'),s("span",{style:{color:"#24292E","--shiki-dark":"#E06C75"}},")"),s("span",{style:{color:"#24292E","--shiki-dark":"#ABB2BF"}},";")]),l(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),X=k(`<p>使用 <code>SXSSFWorkbook</code> 优化导出： 通过建立中间缓存文件优化导出速度</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes github-light one-dark-pro" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#24292E;--shiki-dark:#E5C07B;">Workbook</span><span style="color:#24292E;--shiki-dark:#E06C75;"> workbook </span><span style="color:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;"> SXSSFWorkbook</span><span style="color:#24292E;--shiki-dark:#E06C75;">()</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">;</span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"> // 将 new HSSFWorkbook() 修改成 new SXSSFWorkbook()</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;"> ...</span><span style="color:#24292E;--shiki-dark:#E06C75;">省略</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E5C07B;">FileOutputStream</span><span style="color:#24292E;--shiki-dark:#E06C75;"> fileOutputStream </span><span style="color:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;"> FileOutputStream</span><span style="color:#24292E;--shiki-dark:#E06C75;">(filepath </span><span style="color:#D73A49;--shiki-dark:#56B6C2;">+</span><span style="color:#032F62;--shiki-dark:#98C379;"> &quot;07版本批量写入.xlsx&quot;</span><span style="color:#24292E;--shiki-dark:#E06C75;">)</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E5C07B;">workbook</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;">write</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(fileOutputStream);</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E06C75;">((SXSSFWorkbook) workbook)</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;">dispose</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">();</span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"> // ❗写完后，清理临时文件，将数据写入过程中产生的缓存文件删除</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用 <code>SXSSFWorkbook</code> 导出耗时：10.959 秒</p><div class="hint-container info"><p class="hint-container-title">相关信息</p><p>从 3.8-beta3 开始，POI 提供了基于 XSSF 的低内存占用的 SXSSF API。</p><p>SXSSF 是 XSSF 的 API 兼容流扩展，可用于必须生成非常大的电子表格且堆空间有限的情况。 SXSSF 通过限制对滑动窗口内的行的访问来实现其低内存占用，而 XSSF 允许对文档中的所有行进行访问。 不再在窗口中的较旧的行将被写入磁盘，因此无法访问。</p><p>在自动刷新模式下，可以指定访问窗口的大小，以在内存中保留一定数量的行。 当达到该值时，附加行的创建将使索引最低的行从访问窗口中删除并写入磁盘。 或者，可以将窗口大小设置为动态增长。可以根据需要通过显式调用 flushRows（int keepRows）定期对其进行修剪。</p><p>由于实现的流性质，与 XSSF 相比存在以下限制：</p><ul><li>在某个时间点只能访问有限数量的行</li><li>不支持 <code>Sheet.clone()</code></li><li>不支持公式评估</li></ul></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>SXSSF 刷新临时文件中的工作表数据（每个 sheet 一个临时文件），这些临时文件的大小可能会增长到非常大的值。 例如，对于 20mb 临时 xml 大小的 csv 数据变得超过十亿字节。 如果临时文件的大小是一个问题，可以使用 gzip 压缩:</p><div class="language-java line-numbers-mode" data-ext="java" data-title="java"><pre class="shiki shiki-themes github-light one-dark-pro" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#24292E;--shiki-dark:#E5C07B;">SXSSFWorkbook</span><span style="color:#24292E;--shiki-dark:#E06C75;"> wb </span><span style="color:#D73A49;--shiki-dark:#56B6C2;">=</span><span style="color:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;"> SXSSFWorkbook</span><span style="color:#24292E;--shiki-dark:#E06C75;">()</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#E5C07B;">wb</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;">setCompressTempFiles</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="color:#005CC5;--shiki-dark:#D19A66;">true</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">);</span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"> //临时文件将被gzip压缩</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="读-excel" tabindex="-1"><a class="header-anchor" href="#读-excel"><span>读 excel</span></a></h2><p>todo https://www.cnblogs.com/Chary/p/18112420</p>`,7);function T(N,H){const n=t("ExternalLinkIcon"),r=t("Tabs");return d(),p("div",null,[y,s("p",null,[l("官网： "),s("a",E,[l("https://poi.apache.org/"),o(n)])]),A,F,u,C,h(" more "),s("blockquote",null,[b,s("ul",null,[s("li",null,[s("a",m,[l("https://github.com/ZhangZiSheng001/poi-demo"),o(n)])])])]),v,o(r,{id:"52",data:[{id:"xls 03"},{id:"xlsx 07"}],"tab-id":"excel_version"},{title0:i(({value:a,isActive:e})=>[l("xls 03")]),title1:i(({value:a,isActive:e})=>[l("xlsx 07")]),tab0:i(({value:a,isActive:e})=>[D]),tab1:i(({value:a,isActive:e})=>[f]),_:1}),S,o(r,{id:"126",data:[{id:"xls 03"},{id:"xlsx 07"}],"tab-id":"excel_version"},{title0:i(({value:a,isActive:e})=>[l("xls 03")]),title1:i(({value:a,isActive:e})=>[l("xlsx 07")]),tab0:i(({value:a,isActive:e})=>[x]),tab1:i(({value:a,isActive:e})=>[g,_]),_:1}),w,o(r,{id:"140",data:[{id:"xls 03"},{id:"xlsx 07"}],"tab-id":"excel_version"},{title0:i(({value:a,isActive:e})=>[l("xls 03")]),title1:i(({value:a,isActive:e})=>[l("xlsx 07")]),tab0:i(({value:a,isActive:e})=>[O,I,W]),tab1:i(({value:a,isActive:e})=>[j,P]),_:1}),X])}const Z=c(B,[["render",T],["__file","excel-poi.html.vue"]]),R=JSON.parse('{"path":"/zh/dev-java-office/excel-poi.html","title":"Apache POI 使用","lang":"zh-CN","frontmatter":{"title":"Apache POI 使用","date":"2024-07-02T00:00:00.000Z","tag":["java","office","excel"],"order":33,"description":"Apache POI 是一个流行的 Java 库，用于处理 Microsoft Office 格式文件，包括 Excel、Word 和 PowerPoint。它提供了丰富的 API，可以创建、读取和修改各种类型的 Office 文档。 官网： https://poi.apache.org/ 优点： 功能强大：支持处理复杂的 Excel 文件，包括单元格...","head":[["meta",{"property":"og:url","content":"https://lawsssscat.github.io/blog/zh/blog/zh/dev-java-office/excel-poi.html"}],["meta",{"property":"og:site_name","content":"个人博客"}],["meta",{"property":"og:title","content":"Apache POI 使用"}],["meta",{"property":"og:description","content":"Apache POI 是一个流行的 Java 库，用于处理 Microsoft Office 格式文件，包括 Excel、Word 和 PowerPoint。它提供了丰富的 API，可以创建、读取和修改各种类型的 Office 文档。 官网： https://poi.apache.org/ 优点： 功能强大：支持处理复杂的 Excel 文件，包括单元格..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-07-02T12:28:56.000Z"}],["meta",{"property":"article:author","content":"Steven"}],["meta",{"property":"article:tag","content":"java"}],["meta",{"property":"article:tag","content":"office"}],["meta",{"property":"article:tag","content":"excel"}],["meta",{"property":"article:published_time","content":"2024-07-02T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-07-02T12:28:56.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Apache POI 使用\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-07-02T00:00:00.000Z\\",\\"dateModified\\":\\"2024-07-02T12:28:56.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Steven\\",\\"url\\":\\"https://github.com/LawssssCat/\\"}]}"]]},"headers":[{"level":2,"title":"引入依赖","slug":"引入依赖","link":"#引入依赖","children":[]},{"level":2,"title":"版本对比","slug":"版本对比","link":"#版本对比","children":[]},{"level":2,"title":"写 excel","slug":"写-excel","link":"#写-excel","children":[]},{"level":2,"title":"写 excel （大文件）","slug":"写-excel-大文件","link":"#写-excel-大文件","children":[]},{"level":2,"title":"读 excel","slug":"读-excel","link":"#读-excel","children":[]}],"git":{"createdTime":1719878612000,"updatedTime":1719923336000,"contributors":[{"name":"lawsssscat","email":"18041500+LawssssCat@users.noreply.github.com","commits":2}]},"readingTime":{"minutes":4.22,"words":1265},"filePathRelative":"zh/dev-java-office/excel-poi.md","localizedDate":"2024年7月2日","excerpt":"<p>Apache POI 是一个流行的 Java 库，用于处理 Microsoft Office 格式文件，包括 Excel、Word 和 PowerPoint。它提供了丰富的 API，可以创建、读取和修改各种类型的 Office 文档。</p>\\n<p>官网： <a href=\\"https://poi.apache.org/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://poi.apache.org/</a></p>\\n<p>优点：</p>\\n<ul>\\n<li>功能强大：支持处理复杂的 Excel 文件，包括单元格、样式、图表等内容。</li>\\n<li>稳定性高：作为一个成熟的开源项目，得到广泛支持和持续维护。</li>\\n<li>灵活性：可以满足各种定制化需求，可以实现复杂的 Excel 处理功能。</li>\\n</ul>\\n<p>缺点：</p>\\n<ul>\\n<li>性能相对较低：在处理大量数据时，性能可能受到一定影响。</li>\\n</ul>\\n","autoDesc":true}');export{Z as comp,R as data};
