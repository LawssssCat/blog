import{_ as d,r as t,o as k,c as h,d as s,e as a,b as n,a as y,w as l,f as p}from"./app-v6wXHRU9.js";const F={},C={href:"https://www.open-scap.org/",target:"_blank",rel:"noopener noreferrer"},u=s("div",{class:"hint-container tip"},[s("p",{class:"hint-container-title"},"提示"),s("p",null,"为什么使用 OpenSCAP 做基线核查？"),s("ul",null,[s("li",null,"完成度高"),s("li",null,"支持 SCAP 组件：检查项（CCE），检查方式（OVAL）和基线标准化（PCI,STIG）等 NIST 和 MITRE 维护的美国政府或者行业标准"),s("li",null,"支持多种运行方式(bash/ansible/openscap)"),s("li",null,"支持问题修复"),s("li",null,"容易扩展，二次开发制作自定义的基线可用的高质量资源较多")])],-1),v={class:"hint-container info"},m=s("p",{class:"hint-container-title"},"相关信息",-1),A=s("p",null,"参考：",-1),b={href:"https://medium.com/defense-unicorns/stig-scanning-with-openscap-675c7292d7cb",target:"_blank",rel:"noopener noreferrer"},f={href:"https://complianceascode.readthedocs.io/en/latest/manual/user/20_scanning.html",target:"_blank",rel:"noopener noreferrer"},g={href:"https://static.open-scap.org/openscap-1.3/oscap_user_manual.html",target:"_blank",rel:"noopener noreferrer"},E=s("p",null,"待整理：",-1),_={href:"https://www.liuchunhua.me/post/security/01openscap/openscap/#documentTop",target:"_blank",rel:"noopener noreferrer"},B=s("li",null,[s("s",null,"todo https://blog.csdn.net/m0_46097570/article/details/119876480")],-1),x=s("h2",{id:"基本功能",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#基本功能"},[s("span",null,"基本功能")])],-1),D=s("p",null,"OpenSCAP 的使用围绕解析基线配置文件和执行基线评估展开，其他功能均为此服务。",-1),S=s("h3",{id:"执行工具和基线库",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#执行工具和基线库"},[s("span",null,"执行工具和基线库")])],-1),P=s("p",null,"OpenSCAP 由工具和基线库（benchmark）两个部分组成：",-1),w=s("p",null,[a("工具 "),s("code",null,"oscap"),a(" 提供规则解析和执行功能")],-1),T=s("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[s("pre",{class:"shiki shiki-themes github-light one-dark-pro",style:{"background-color":"#fff","--shiki-dark-bg":"#282c34",color:"#24292e","--shiki-dark":"#abb2bf"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"sudo"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," apt"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," install"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," libopenscap8")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"oscap"),s("span",{style:{color:"#005CC5","--shiki-dark":"#D19A66"}}," -V")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),O=s("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[s("pre",{class:"shiki shiki-themes github-light one-dark-pro",style:{"background-color":"#fff","--shiki-dark-bg":"#282c34",color:"#24292e","--shiki-dark":"#abb2bf"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"yum"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," install"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," openscap-utils")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"yum"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," install"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," openscap-scanner")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),I=s("p",null,"基线库提供机器可读格式 （XCCDF）文件。其内容一般由 STIG（和其他安全准则）转换得来。OpenSCAP 可以使用该格式扫描系统的漏洞和合规性。 基线库如：",-1),q={href:"https://www.open-scap.org/security-policies/scap-security-guide/#install",target:"_blank",rel:"noopener noreferrer"},L=s("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[s("pre",{class:"shiki shiki-themes github-light one-dark-pro",style:{"background-color":"#fff","--shiki-dark-bg":"#282c34",color:"#24292e","--shiki-dark":"#abb2bf"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D","--shiki-dark":"#7F848E","font-style":"inherit","--shiki-dark-font-style":"italic"}},"# 下载")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"sudo"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," apt"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," install"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," ssg-debderived")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D","--shiki-dark":"#7F848E","font-style":"inherit","--shiki-dark-font-style":"italic"}},"# You can install SCAP Security Guide on Ubuntu 18.04 and newer using apt:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"apt"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," install"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," ssg-base"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," ssg-debderived"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," ssg-debian"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," ssg-nondebian"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," ssg-applications")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),V=s("p",null,"参考：",-1),R={href:"https://ubuntu.com/security/disa-stig",target:"_blank",rel:"noopener noreferrer"},N=s("div",{class:"language-bash line-numbers-mode","data-ext":"sh","data-title":"sh"},[s("pre",{class:"shiki shiki-themes github-light one-dark-pro",style:{"background-color":"#fff","--shiki-dark-bg":"#282c34",color:"#24292e","--shiki-dark":"#abb2bf"},tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6F42C1","--shiki-dark":"#61AFEF"}},"$"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," yum"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," install"),s("span",{style:{color:"#032F62","--shiki-dark":"#98C379"}}," scap-security-guide")]),a(`
`),s("span",{class:"line"})])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),X={href:"https://github.com/ComplianceAsCode/content",target:"_blank",rel:"noopener noreferrer"},U=p(`<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="shiki shiki-themes github-light one-dark-pro" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">sudo</span><span style="color:#032F62;--shiki-dark:#98C379;"> wget</span><span style="color:#032F62;--shiki-dark:#98C379;"> https://github.com/ComplianceAsCode/content/releases/download/v0.1.69/scap-security-guide-0.1.69.zip</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,1),j={class:"hint-container tip"},G=s("p",{class:"hint-container-title"},"提示",-1),z={href:"http://vuls.io",target:"_blank",rel:"noopener noreferrer"},M=s("p",null,"例子：",-1),Z=p(`<h3 id="扫描基线和扫描结果" tabindex="-1"><a class="header-anchor" href="#扫描基线和扫描结果"><span>扫描基线和扫描结果</span></a></h3><p>有了 oscap 工具和基线库后，可通过 <code>oscap info ssg-ubuntu2004-ds-1.2.xml</code> 查看内容：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="shiki shiki-themes github-light one-dark-pro" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="color:#032F62;--shiki-dark:#98C379;"> oscap</span><span style="color:#032F62;--shiki-dark:#98C379;"> info</span><span style="color:#032F62;--shiki-dark:#98C379;"> ssg-ubuntu2204-ds-1.2.xml</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Document</span><span style="color:#032F62;--shiki-dark:#98C379;"> type:</span><span style="color:#032F62;--shiki-dark:#98C379;"> Source</span><span style="color:#032F62;--shiki-dark:#98C379;"> Data</span><span style="color:#032F62;--shiki-dark:#98C379;"> Stream</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Imported:</span><span style="color:#032F62;--shiki-dark:#98C379;"> 2023-08-02T09:12:43</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Stream:</span><span style="color:#032F62;--shiki-dark:#98C379;"> scap_org.open-scap_datastream_from_xccdf_ssg-ubuntu2204-xccdf.xml</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Generated:</span><span style="color:#24292E;--shiki-dark:#ABB2BF;"> (null)</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Version:</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 1.2</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Checklists:</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">        Ref-Id:</span><span style="color:#032F62;--shiki-dark:#98C379;"> scap_org.open-scap_cref_ssg-ubuntu2204-xccdf.xml</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                Status:</span><span style="color:#032F62;--shiki-dark:#98C379;"> draft</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                Generated:</span><span style="color:#032F62;--shiki-dark:#98C379;"> 2023-08-02</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                Resolved:</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> true</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                Profiles:</span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"> # 💡配置文件</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                        Title:</span><span style="color:#032F62;--shiki-dark:#98C379;"> CIS</span><span style="color:#032F62;--shiki-dark:#98C379;"> Ubuntu</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 22.04</span><span style="color:#032F62;--shiki-dark:#98C379;"> Level</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="color:#032F62;--shiki-dark:#98C379;"> Server</span><span style="color:#032F62;--shiki-dark:#98C379;"> Benchmark</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                                Id:</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf_org.ssgproject.content_profile_cis_level1_server</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                        Title:</span><span style="color:#032F62;--shiki-dark:#98C379;"> CIS</span><span style="color:#032F62;--shiki-dark:#98C379;"> Ubuntu</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 22.04</span><span style="color:#032F62;--shiki-dark:#98C379;"> Level</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="color:#032F62;--shiki-dark:#98C379;"> Workstation</span><span style="color:#032F62;--shiki-dark:#98C379;"> Benchmark</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                                Id:</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf_org.ssgproject.content_profile_cis_level1_workstation</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                        Title:</span><span style="color:#032F62;--shiki-dark:#98C379;"> CIS</span><span style="color:#032F62;--shiki-dark:#98C379;"> Ubuntu</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 22.04</span><span style="color:#032F62;--shiki-dark:#98C379;"> Level</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="color:#032F62;--shiki-dark:#98C379;"> Server</span><span style="color:#032F62;--shiki-dark:#98C379;"> Benchmark</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                                Id:</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf_org.ssgproject.content_profile_cis_level2_server</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                        Title:</span><span style="color:#032F62;--shiki-dark:#98C379;"> CIS</span><span style="color:#032F62;--shiki-dark:#98C379;"> Ubuntu</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 22.04</span><span style="color:#032F62;--shiki-dark:#98C379;"> Level</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 2</span><span style="color:#032F62;--shiki-dark:#98C379;"> Workstation</span><span style="color:#032F62;--shiki-dark:#98C379;"> Benchmark</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                                Id:</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf_org.ssgproject.content_profile_cis_level2_workstation</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                        Title:</span><span style="color:#032F62;--shiki-dark:#98C379;"> Standard</span><span style="color:#032F62;--shiki-dark:#98C379;"> System</span><span style="color:#032F62;--shiki-dark:#98C379;"> Security</span><span style="color:#032F62;--shiki-dark:#98C379;"> Profile</span><span style="color:#032F62;--shiki-dark:#98C379;"> for</span><span style="color:#032F62;--shiki-dark:#98C379;"> Ubuntu</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 22.04</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                                Id:</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf_org.ssgproject.content_profile_standard</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                Referenced</span><span style="color:#032F62;--shiki-dark:#98C379;"> check</span><span style="color:#032F62;--shiki-dark:#98C379;"> files:</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                        ssg-ubuntu2204-oval.xml</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                                system:</span><span style="color:#032F62;--shiki-dark:#98C379;"> http://oval.mitre.org/XMLSchema/oval-definitions-5</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                        ssg-ubuntu2204-ocil.xml</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">                                system:</span><span style="color:#032F62;--shiki-dark:#98C379;"> http://scap.nist.gov/schema/ocil/2</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Checks:</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">        Ref-Id:</span><span style="color:#032F62;--shiki-dark:#98C379;"> scap_org.open-scap_cref_ssg-ubuntu2204-oval.xml</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">        Ref-Id:</span><span style="color:#032F62;--shiki-dark:#98C379;"> scap_org.open-scap_cref_ssg-ubuntu2204-ocil.xml</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">        Ref-Id:</span><span style="color:#032F62;--shiki-dark:#98C379;"> scap_org.open-scap_cref_ssg-ubuntu2204-cpe-oval.xml</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Dictionaries:</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">        Ref-Id:</span><span style="color:#032F62;--shiki-dark:#98C379;"> scap_org.open-scap_cref_ssg-ubuntu2204-cpe-dictionary.xml</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>针对 ssg 文件的 profile xccdf 配置，使用 <code>oscap xccdf eval</code> 进行评估：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="shiki shiki-themes github-light one-dark-pro" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># oscap [options] module operation [operation-options-and-arguments]</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">oscap</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf</span><span style="color:#032F62;--shiki-dark:#98C379;"> eval</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --profile</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf_org.ssgproject.content_profile_standard</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --report</span><span style="color:#032F62;--shiki-dark:#98C379;"> report.html</span><span style="color:#032F62;--shiki-dark:#98C379;"> ssg-ubuntu2204-ds-1.2.xml</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># --results results.xml 可用于问题修复</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">oscap</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf</span><span style="color:#032F62;--shiki-dark:#98C379;"> eval</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --profile</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf_org.ssgproject.content_profile_standard</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --report</span><span style="color:#032F62;--shiki-dark:#98C379;"> report.html</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --results</span><span style="color:#032F62;--shiki-dark:#98C379;"> results.xml</span><span style="color:#032F62;--shiki-dark:#98C379;"> ssg-ubuntu2204-ds-1.2.xml</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>例子：</p>`,6),$=s("h3",{id:"针对扫描结果进行修复",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#针对扫描结果进行修复"},[s("span",null,"针对扫描结果进行修复")])],-1),J={href:"https://csrc.nist.gov/pubs/sp/800/37/r2/final",target:"_blank",rel:"noopener noreferrer"},W=p(`<p><code>--results results.xml</code> 生成如下结果：</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="shiki shiki-themes github-light one-dark-pro" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;">&lt;!-- 对应的 XCCDF 检查清单检查项 --&gt;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#22863A;--shiki-dark:#E06C75;">rule-result</span><span style="color:#6F42C1;--shiki-dark:#D19A66;"> idref</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;ensure_gpgcheck_globally_activated&quot;</span><span style="color:#6F42C1;--shiki-dark:#D19A66;"> time</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;2023-02-16T10:03:43&quot;</span><span style="color:#6F42C1;--shiki-dark:#D19A66;"> severity</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;high&quot;</span><span style="color:#6F42C1;--shiki-dark:#D19A66;"> weight</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;1.000000&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;">  &lt;!-- 通过/失败/不适用 --&gt;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">  &lt;</span><span style="color:#22863A;--shiki-dark:#E06C75;">result</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">&gt;pass&lt;/</span><span style="color:#22863A;--shiki-dark:#E06C75;">result</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;">  &lt;!-- 对应的检查项问题 --&gt;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">  &lt;</span><span style="color:#22863A;--shiki-dark:#E06C75;">ident</span><span style="color:#6F42C1;--shiki-dark:#D19A66;"> system</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;http://cce.mitre.org&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">&gt;CCE-83457-2&lt;/</span><span style="color:#22863A;--shiki-dark:#E06C75;">ident</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;">  &lt;!-- 对应的 OVAL 检查项检查实现（检查方式） --&gt;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">  &lt;</span><span style="color:#22863A;--shiki-dark:#E06C75;">check</span><span style="color:#6F42C1;--shiki-dark:#D19A66;"> system</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;http://oval.mitre.org/XMLSchema/oval-definitions-5&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">    &lt;</span><span style="color:#22863A;--shiki-dark:#E06C75;">check-content-ref</span><span style="color:#6F42C1;--shiki-dark:#D19A66;"> name</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;oval:ssg:def:413&quot;</span><span style="color:#6F42C1;--shiki-dark:#D19A66;"> href</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;ssg-rhel9-oval.xml&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">  &lt;/</span><span style="color:#22863A;--shiki-dark:#E06C75;">check</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">&lt;/</span><span style="color:#22863A;--shiki-dark:#E06C75;">rule-result</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">......</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#22863A;--shiki-dark:#E06C75;">rule-result</span><span style="color:#6F42C1;--shiki-dark:#D19A66;"> idref</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;package_aide_installed&quot;</span><span style="color:#6F42C1;--shiki-dark:#D19A66;"> time</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;2023-02-16T10:03:43&quot;</span><span style="color:#6F42C1;--shiki-dark:#D19A66;"> severity</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;medium&quot;</span><span style="color:#6F42C1;--shiki-dark:#D19A66;"> weight</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;1.000000&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">  &lt;</span><span style="color:#22863A;--shiki-dark:#E06C75;">result</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">&gt;pass&lt;/</span><span style="color:#22863A;--shiki-dark:#E06C75;">result</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">  &lt;</span><span style="color:#22863A;--shiki-dark:#E06C75;">ident</span><span style="color:#6F42C1;--shiki-dark:#D19A66;"> system</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;http://cce.mitre.org&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">&gt;CCE-90843-4&lt;/</span><span style="color:#22863A;--shiki-dark:#E06C75;">ident</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;">  &lt;!-- 修正的 bash 脚本 --&gt;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">  &lt;</span><span style="color:#22863A;--shiki-dark:#E06C75;">fix</span><span style="color:#6F42C1;--shiki-dark:#D19A66;"> xmlns:xhtml</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;http://www.w3.org/1999/xhtml&quot;</span><span style="color:#6F42C1;--shiki-dark:#D19A66;"> system</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;urn:xccdf:fix:script:sh&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">    yum -y install aide</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">  &lt;/</span><span style="color:#22863A;--shiki-dark:#E06C75;">fix</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">  &lt;</span><span style="color:#22863A;--shiki-dark:#E06C75;">check</span><span style="color:#6F42C1;--shiki-dark:#D19A66;"> system</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;http://oval.mitre.org/XMLSchema/oval-definitions-5&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">    &lt;</span><span style="color:#22863A;--shiki-dark:#E06C75;">check-content-ref</span><span style="color:#6F42C1;--shiki-dark:#D19A66;"> name</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;oval:ssg:def:245&quot;</span><span style="color:#6F42C1;--shiki-dark:#D19A66;"> href</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">=</span><span style="color:#032F62;--shiki-dark:#98C379;">&quot;ssg-rhel9-oval.xml&quot;</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">  &lt;/</span><span style="color:#22863A;--shiki-dark:#E06C75;">check</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#ABB2BF;">&lt;/</span><span style="color:#22863A;--shiki-dark:#E06C75;">rule-result</span><span style="color:#24292E;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>生成修复脚本</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="shiki shiki-themes github-light one-dark-pro" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 生成 bash 脚本</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">oscap</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf</span><span style="color:#032F62;--shiki-dark:#98C379;"> generate</span><span style="color:#032F62;--shiki-dark:#98C379;"> fix</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --profile</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf_org.ssgproject.content_profile_standard</span><span style="color:#032F62;--shiki-dark:#98C379;"> results.xml</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># oscap xccdf generate fix --profile xccdf_org.ssgproject.content_profile_standard -o fix.sh results.xml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 生成 ansible 脚本</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">oscap</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf</span><span style="color:#032F62;--shiki-dark:#98C379;"> generate</span><span style="color:#032F62;--shiki-dark:#98C379;"> fix</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --profile</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf_org.ssgproject.content_profile_standard</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --fix-type</span><span style="color:#032F62;--shiki-dark:#98C379;"> ansible</span><span style="color:#032F62;--shiki-dark:#98C379;"> results.xml</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>例子：</p>`,5),H=p(`<h2 id="组件" tabindex="-1"><a class="header-anchor" href="#组件"><span>组件</span></a></h2><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="shiki shiki-themes github-light one-dark-pro" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="color:#032F62;--shiki-dark:#98C379;"> oscap</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> -h</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">oscap</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">OpenSCAP</span><span style="color:#032F62;--shiki-dark:#98C379;"> command-line</span><span style="color:#032F62;--shiki-dark:#98C379;"> tool</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Usage:</span><span style="color:#032F62;--shiki-dark:#98C379;"> oscap</span><span style="color:#24292E;--shiki-dark:#ABB2BF;"> [options] module operation [operation-options-and-arguments]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">oscap</span><span style="color:#032F62;--shiki-dark:#98C379;"> options:</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">   -h</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --help</span><span style="color:#032F62;--shiki-dark:#98C379;">                     -</span><span style="color:#032F62;--shiki-dark:#98C379;"> show</span><span style="color:#032F62;--shiki-dark:#98C379;"> this</span><span style="color:#032F62;--shiki-dark:#98C379;"> help</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">   -q</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --quiet</span><span style="color:#032F62;--shiki-dark:#98C379;">                    -</span><span style="color:#032F62;--shiki-dark:#98C379;"> quiet</span><span style="color:#032F62;--shiki-dark:#98C379;"> mode</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">   -V</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --version</span><span style="color:#032F62;--shiki-dark:#98C379;">                  -</span><span style="color:#032F62;--shiki-dark:#98C379;"> print</span><span style="color:#032F62;--shiki-dark:#98C379;"> info</span><span style="color:#032F62;--shiki-dark:#98C379;"> about</span><span style="color:#032F62;--shiki-dark:#98C379;"> supported</span><span style="color:#032F62;--shiki-dark:#98C379;"> SCAP</span><span style="color:#032F62;--shiki-dark:#98C379;"> versions</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Commands:</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">    ds</span><span style="color:#032F62;--shiki-dark:#98C379;"> -</span><span style="color:#032F62;--shiki-dark:#98C379;"> DataStream</span><span style="color:#032F62;--shiki-dark:#98C379;"> utilities</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">    oval</span><span style="color:#032F62;--shiki-dark:#98C379;"> -</span><span style="color:#032F62;--shiki-dark:#98C379;"> Open</span><span style="color:#032F62;--shiki-dark:#98C379;"> Vulnerability</span><span style="color:#032F62;--shiki-dark:#98C379;"> and</span><span style="color:#032F62;--shiki-dark:#98C379;"> Assessment</span><span style="color:#032F62;--shiki-dark:#98C379;"> Language</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">    xccdf</span><span style="color:#032F62;--shiki-dark:#98C379;"> -</span><span style="color:#032F62;--shiki-dark:#98C379;"> eXtensible</span><span style="color:#032F62;--shiki-dark:#98C379;"> Configuration</span><span style="color:#032F62;--shiki-dark:#98C379;"> Checklist</span><span style="color:#032F62;--shiki-dark:#98C379;"> Description</span><span style="color:#032F62;--shiki-dark:#98C379;"> Format</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">    cvss</span><span style="color:#032F62;--shiki-dark:#98C379;"> -</span><span style="color:#032F62;--shiki-dark:#98C379;"> Common</span><span style="color:#032F62;--shiki-dark:#98C379;"> Vulnerability</span><span style="color:#032F62;--shiki-dark:#98C379;"> Scoring</span><span style="color:#032F62;--shiki-dark:#98C379;"> System</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">    cpe</span><span style="color:#032F62;--shiki-dark:#98C379;"> -</span><span style="color:#032F62;--shiki-dark:#98C379;"> Common</span><span style="color:#032F62;--shiki-dark:#98C379;"> Platform</span><span style="color:#032F62;--shiki-dark:#98C379;"> Enumeration</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">    cve</span><span style="color:#032F62;--shiki-dark:#98C379;"> -</span><span style="color:#032F62;--shiki-dark:#98C379;"> Common</span><span style="color:#032F62;--shiki-dark:#98C379;"> Vulnerabilities</span><span style="color:#032F62;--shiki-dark:#98C379;"> and</span><span style="color:#032F62;--shiki-dark:#98C379;"> Exposures</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">    cvrf</span><span style="color:#032F62;--shiki-dark:#98C379;"> -</span><span style="color:#032F62;--shiki-dark:#98C379;"> Common</span><span style="color:#032F62;--shiki-dark:#98C379;"> Vulnerability</span><span style="color:#032F62;--shiki-dark:#98C379;"> Reporting</span><span style="color:#032F62;--shiki-dark:#98C379;"> Framework</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">    info</span><span style="color:#032F62;--shiki-dark:#98C379;"> -</span><span style="color:#032F62;--shiki-dark:#98C379;"> info</span><span style="color:#032F62;--shiki-dark:#98C379;"> module</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="oval-组件" tabindex="-1"><a class="header-anchor" href="#oval-组件"><span>OVAL 组件</span></a></h3><p>OVAL 系统信息收集 —— 解析 OVAL 定义，收集系统信息，生成 OVAL 评估结果</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="shiki shiki-themes github-light one-dark-pro" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 评估 scap-oval.xml 中的所有定义，生成 oval-results.xml 评估结果</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">oscap</span><span style="color:#032F62;--shiki-dark:#98C379;"> oval</span><span style="color:#032F62;--shiki-dark:#98C379;"> eval</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --results</span><span style="color:#032F62;--shiki-dark:#98C379;"> oval-results.xml</span><span style="color:#032F62;--shiki-dark:#98C379;"> scap-oval.xml</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 评估特定 oval:rhel:def:1000 定义</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">oscap</span><span style="color:#032F62;--shiki-dark:#98C379;"> oval</span><span style="color:#032F62;--shiki-dark:#98C379;"> eval</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --id</span><span style="color:#032F62;--shiki-dark:#98C379;"> oval:rhel:def:1000</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --results</span><span style="color:#032F62;--shiki-dark:#98C379;"> oval-results.xml</span><span style="color:#032F62;--shiki-dark:#98C379;"> scap-oval.xml</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 评估 OVAL 组件的所有定义，这些定义是 SCAP 数据流集合中特定数据流的一部分</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">oscap</span><span style="color:#032F62;--shiki-dark:#98C379;"> oval</span><span style="color:#032F62;--shiki-dark:#98C379;"> eval</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --datastream-id</span><span style="color:#032F62;--shiki-dark:#98C379;"> ds.xml</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --oval-id</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf.xml</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --results</span><span style="color:#032F62;--shiki-dark:#98C379;"> oval-results.xml</span><span style="color:#032F62;--shiki-dark:#98C379;"> scap-ds.xml</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="xccdf-组件" tabindex="-1"><a class="header-anchor" href="#xccdf-组件"><span>XCCDF 组件</span></a></h3><p>XCCDF 基准评估 —— 在评估 XCCDF 基准时，oscap 会处理 XCCDF 文件、OVAL 文件、 CPE 词典。执行这些系统分析，并在此分析的基础上产生 XCCDF 结果</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="shiki shiki-themes github-light one-dark-pro" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 评估 XCCDF 文件中的特定配置文件</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># | scap-xccdf.xml     是 XCCDF 文档</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># | Desktop            是从 XCCDF 文档中选择的配置文件</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># | xccdf-results.xml  是存储扫描结果的文件</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># | cpe-dictionary.xml 是 CPE 词典</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">oscap</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf</span><span style="color:#032F62;--shiki-dark:#98C379;"> eval</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --profile</span><span style="color:#032F62;--shiki-dark:#98C379;"> Desktop</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --results</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf-results.xml</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --cpe</span><span style="color:#032F62;--shiki-dark:#98C379;"> cpe-dictionary.xml</span><span style="color:#032F62;--shiki-dark:#98C379;"> scap-xccdf.xml</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 指定要评估的规则</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 这里的规则 “sures_gpgcheck_globally_activated” 是 “Desktop” 配置文件中将要评估的唯一规则</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">oscap</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf</span><span style="color:#032F62;--shiki-dark:#98C379;"> eval</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --profile</span><span style="color:#032F62;--shiki-dark:#98C379;"> Desktop</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --rule</span><span style="color:#032F62;--shiki-dark:#98C379;"> ensure_gpgcheck_globally_activated</span><span style="color:#005CC5;--shiki-dark:#D19A66;">  --results</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf-results.xml</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --cpe</span><span style="color:#032F62;--shiki-dark:#98C379;"> cpe-dictionary.xml</span><span style="color:#032F62;--shiki-dark:#98C379;"> scap-xccdf.xml</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 评估作为 SCAP DataStream 集合内 DataStream 一部分的特定 XCCDF 基准</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># | scap-ds.xml       是表示 SCAP DataStream 集合的文件</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># | ds.xml            是特定的 DataStream</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># | xccdf.xml         是指向所需 XCCDF 文档的 component-ref 的 ID</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># | xccdf-results.xml 是包含以下内容的文件扫描结果</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">oscap</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf</span><span style="color:#032F62;--shiki-dark:#98C379;"> eval</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --datastream-id</span><span style="color:#032F62;--shiki-dark:#98C379;"> ds.xml</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --xccdf-id</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf.xml</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --results</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf-results.xml</span><span style="color:#032F62;--shiki-dark:#98C379;"> scap-ds.xml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 生成 arf 格式的评估结果</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">oscap</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf</span><span style="color:#032F62;--shiki-dark:#98C379;"> eval</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --benchmark-id</span><span style="color:#032F62;--shiki-dark:#98C379;"> Benchmark_id</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --results-arf</span><span style="color:#032F62;--shiki-dark:#98C379;"> arf-results.xml</span><span style="color:#032F62;--shiki-dark:#98C379;"> scap-ds.xml</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 生成可导入 DISA STIG Viewer 的评估结果</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">oscap</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf</span><span style="color:#032F62;--shiki-dark:#98C379;"> eval</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --profile</span><span style="color:#032F62;--shiki-dark:#98C379;"> stig-rhel7-disa</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> --stig-viewer</span><span style="color:#032F62;--shiki-dark:#98C379;"> results-stig.xml</span><span style="color:#032F62;--shiki-dark:#98C379;"> ssg-rhel7-ds.xml</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>STIG Viewing Tools https://public.cyber.mil/stigs/srg-stig-tools/</p></blockquote><p>例子：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="shiki shiki-themes github-light one-dark-pro" style="background-color:#fff;--shiki-dark-bg:#282c34;color:#24292e;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 列出当前可用的基线库</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="color:#032F62;--shiki-dark:#98C379;"> ll</span><span style="color:#032F62;--shiki-dark:#98C379;"> /usr/share/xml/scap/ssg/content/</span><span style="color:#D73A49;--shiki-dark:#ABB2BF;"> |</span><span style="color:#6F42C1;--shiki-dark:#61AFEF;"> grep</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf\`</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">-rw-r--r--</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="color:#032F62;--shiki-dark:#98C379;"> root root </span><span style="color:#005CC5;--shiki-dark:#D19A66;">5086947</span><span style="color:#032F62;--shiki-dark:#98C379;"> Aug </span><span style="color:#005CC5;--shiki-dark:#D19A66;">23</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 2019</span><span style="color:#032F62;--shiki-dark:#98C379;"> ssg-centos6-xccdf.xml</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">-rw-r--r--</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="color:#032F62;--shiki-dark:#98C379;"> root root </span><span style="color:#005CC5;--shiki-dark:#D19A66;">8156658</span><span style="color:#032F62;--shiki-dark:#98C379;"> Aug </span><span style="color:#005CC5;--shiki-dark:#D19A66;">23</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 2019</span><span style="color:#032F62;--shiki-dark:#98C379;"> ssg-centos7-xccdf.xml </span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 当前系统为 Centos 7，所以选择 ssg-centos7-xccdf.xml</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">-rw-r--r--</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="color:#032F62;--shiki-dark:#98C379;"> root root </span><span style="color:#005CC5;--shiki-dark:#D19A66;">145235</span><span style="color:#032F62;--shiki-dark:#98C379;"> Aug </span><span style="color:#005CC5;--shiki-dark:#D19A66;">23</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 2019</span><span style="color:#032F62;--shiki-dark:#98C379;"> ssg-firefox-xccdf.xml</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">-rw-r--r--</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="color:#032F62;--shiki-dark:#98C379;"> root root </span><span style="color:#005CC5;--shiki-dark:#D19A66;">113243</span><span style="color:#032F62;--shiki-dark:#98C379;"> Aug </span><span style="color:#005CC5;--shiki-dark:#D19A66;">23</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 2019</span><span style="color:#032F62;--shiki-dark:#98C379;"> ssg-jre-xccdf.xml </span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 如果系统安装了 Java 环境，之后也可以使用 ssg-jre-xccdf.xml 对 Java 进行核查</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">-rw-r--r--</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="color:#032F62;--shiki-dark:#98C379;"> root root </span><span style="color:#005CC5;--shiki-dark:#D19A66;">5410079</span><span style="color:#032F62;--shiki-dark:#98C379;"> Aug </span><span style="color:#005CC5;--shiki-dark:#D19A66;">23</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 2019</span><span style="color:#032F62;--shiki-dark:#98C379;"> ssg-rhel6-xccdf.xml</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">-rw-r--r--</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 1</span><span style="color:#032F62;--shiki-dark:#98C379;"> root root </span><span style="color:#005CC5;--shiki-dark:#D19A66;">8671063</span><span style="color:#032F62;--shiki-dark:#98C379;"> Aug </span><span style="color:#005CC5;--shiki-dark:#D19A66;">23</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> 2019</span><span style="color:#032F62;--shiki-dark:#98C379;"> ssg-rhel7-xccdf</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 查看基线库内容</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 里面有 5 个基线（Profiles），不同的基线检查项目数量和结果判断标准不同</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">$</span><span style="color:#032F62;--shiki-dark:#98C379;"> oscap info /usr/share/scap-security-guide/ssg-ubuntu1604-xccdf.xml</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Document</span><span style="color:#032F62;--shiki-dark:#98C379;"> type: XCCDF Checklist</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Checklist</span><span style="color:#032F62;--shiki-dark:#98C379;"> version: </span><span style="color:#005CC5;--shiki-dark:#D19A66;">1.1</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Imported:</span><span style="color:#032F62;--shiki-dark:#98C379;"> 2017-08-11T17:18:08</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Status:</span><span style="color:#032F62;--shiki-dark:#98C379;"> draft</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Generated:</span><span style="color:#032F62;--shiki-dark:#98C379;"> 2017-08-11</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Resolved:</span><span style="color:#005CC5;--shiki-dark:#D19A66;"> true</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Profiles:</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Title:</span><span style="color:#032F62;--shiki-dark:#98C379;"> Common Profile for General-Purpose Ubuntu Systems</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Id:</span><span style="color:#032F62;--shiki-dark:#98C379;"> common </span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 基线 1：如果是 Centos7，可以选择 standard</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Title:</span><span style="color:#032F62;--shiki-dark:#98C379;"> Profile for ANSSI DAT-NT28 Minimal Level</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Id:</span><span style="color:#032F62;--shiki-dark:#98C379;"> anssi_np_nt28_minimal </span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 基线 2</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Title:</span><span style="color:#032F62;--shiki-dark:#98C379;"> Profile for ANSSI DAT-NT28 Average (Intermediate) Level</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Id:</span><span style="color:#032F62;--shiki-dark:#98C379;"> anssi_np_nt28_average </span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 基线 3</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Title:</span><span style="color:#032F62;--shiki-dark:#98C379;"> Profile for ANSSI DAT-NT28 Restrictive Level</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Id:</span><span style="color:#032F62;--shiki-dark:#98C379;"> anssi_np_nt28_restrictive </span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 基线 4</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Title:</span><span style="color:#032F62;--shiki-dark:#98C379;"> Profile for ANSSI DAT-NT28 High (Enforced) Level</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Id:</span><span style="color:#032F62;--shiki-dark:#98C379;"> anssi_np_nt28_high </span><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 基线 5</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">Referenced</span><span style="color:#032F62;--shiki-dark:#98C379;"> check files:</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">ssg-ubuntu1604-oval.xml</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">system:</span><span style="color:#032F62;--shiki-dark:#98C379;"> http://oval.mitre.org/XMLSchema/oval-definitions-5</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">ssg-ubuntu1604-ocil.xml</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">system:</span><span style="color:#032F62;--shiki-dark:#98C379;"> http://scap.nist.gov/schema/ocil/2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># 执行核查，生成报告</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># --profile 指定基线 Id</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># --results-arf 指定生成的 arf 报告文件</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#7F848E;font-style:inherit;--shiki-dark-font-style:italic;"># --report 指定生成的 html 报告文件名</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#61AFEF;">oscap</span><span style="color:#032F62;--shiki-dark:#98C379;"> xccdf eval </span><span style="color:#005CC5;--shiki-dark:#D19A66;">--profile</span><span style="color:#032F62;--shiki-dark:#98C379;"> standard </span><span style="color:#005CC5;--shiki-dark:#D19A66;">--results-arf</span><span style="color:#032F62;--shiki-dark:#98C379;"> arf.xml </span><span style="color:#005CC5;--shiki-dark:#D19A66;">--report</span><span style="color:#032F62;--shiki-dark:#98C379;"> report.html /usr/share/xml/scap/ssg/content/ssg-centos7-xccdf.xml</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>ARF（Asset Reporting Format，资产报告格式）</strong> 方便结果传输的一种格式，也被称为 RD（Result DataStream，结果数据流）。</p></blockquote><h2 id="构成" tabindex="-1"><a class="header-anchor" href="#构成"><span>构成</span></a></h2><p>OpenScap 构成：</p><ul><li>OpenSCAP Base —— 即 <code>oscap</code> 命令行工具，本地扫描，适合做一次性的服务。 （1.2.3 开始有支持 ssh 的远程扫描。远程扫描需要在远程主机上已经安装 OpenSCAP Base）</li><li>OpenSCAP Daemon —— 守护进程工具，功能同 OpenSCAP Base，适合做持续的合规服务</li><li>SCAP Workbench —— 图形界面，功能同 SCAP Base，适合入门，可视化操作</li><li>SCAP Timony —— 中间件，数据存储服务，用于存储基础结构的 SCAP 结果，然后允许对存储的数据进行操作。一般搭配 OpenSCAP Daemon 使用</li></ul>`,15);function Y(K,Q){const i=t("ExternalLinkIcon"),c=t("Tabs"),o=t("SiteLink");return k(),h("div",null,[s("p",null,[s("a",C,[a("OpenSCAP"),n(i)]),a(" 是一个遵循 SCAP 标准的开源工具，目的是根据安全策略和配置文件评估本地系统的漏洞和标准配置。 OpenSCAP 支持基线核查（漏洞扫描/配置评估/合规性核查），报告和自动修复，目前主要有 Redhat 进行维护。")]),u,y(" more "),s("div",v,[m,A,s("ul",null,[s("li",null,[a("STIG Scanning with OpenSCAP —— "),s("a",b,[a("https://medium.com/defense-unicorns/stig-scanning-with-openscap-675c7292d7cb"),n(i)])]),s("li",null,[a("Running a Scan with OpenSCAP —— "),s("a",f,[a("https://complianceascode.readthedocs.io/en/latest/manual/user/20_scanning.html"),n(i)])]),s("li",null,[a("OpenSCAP User Manual —— "),s("a",g,[a("https://static.open-scap.org/openscap-1.3/oscap_user_manual.html"),n(i)])])]),E,s("ul",null,[s("li",null,[a("OpenSCAP 系统漏洞扫描及加固解决方案 - "),s("a",_,[a("https://www.liuchunhua.me/post/security/01openscap/openscap/#documentTop"),n(i)])]),B])]),x,D,S,P,s("ul",null,[s("li",null,[w,n(c,{id:"90",data:[{id:"Ubuntu"},{id:"Centos"}],"tab-id":"usage"},{title0:l(({value:e,isActive:r})=>[a("Ubuntu")]),title1:l(({value:e,isActive:r})=>[a("Centos")]),tab0:l(({value:e,isActive:r})=>[T]),tab1:l(({value:e,isActive:r})=>[O]),_:1})]),s("li",null,[I,s("ul",null,[s("li",null,[s("p",null,[s("a",q,[a("SSG（SCAP Security Guide，SCAP 安全指导）"),n(i)])]),n(c,{id:"108",data:[{id:"Ubuntu"},{id:"Centos"}],"tab-id":"usage"},{title0:l(({value:e,isActive:r})=>[a("Ubuntu")]),title1:l(({value:e,isActive:r})=>[a("Centos")]),tab0:l(({value:e,isActive:r})=>[L,V,s("ul",null,[s("li",null,[s("a",R,[a("https://ubuntu.com/security/disa-stig"),n(i)])])])]),tab1:l(({value:e,isActive:r})=>[N]),_:1})]),s("li",null,[s("p",null,[a("开源项目 "),s("a",X,[a("ComplianceAsCode"),n(i)])]),U])])])]),s("div",j,[G,s("p",null,[a("OpenSCAP 工具和基线库两者没有紧密的耦合关系，比如使用 "),s("a",z,[a("http://vuls.io"),n(i)]),a(" 也可以运行部分基线库，基线库部分功能也支持使用 ansible 和 bash 来执行。")])]),M,s("ul",null,[s("li",null,[a("评估清单 "),n(o,{path:"/code/demo-scap-tools/try-openscap-01/ssg-ubuntu2204-ds-1.2.xml"})])]),Z,s("ul",null,[s("li",null,[a("评估系统 "),n(o,{path:"/code/demo-scap-tools/try-openscap-01/target-info.txt"})]),s("li",null,[a("评估报告（xml） "),n(o,{path:"/code/demo-scap-tools/try-openscap-01/results.xml"})]),s("li",null,[a("评估报告（html） "),n(o,{path:"/code/demo-scap-tools/try-openscap-01/report.xml"})])]),$,s("p",null,[a("todo "),s("a",J,[a("RMF（Risk Management Framework，风险管理框架）"),n(i)]),a(" 是 NIST 的出版物，为如何有效管理信息安全和隐私风险提供了指导，为组织提供了一种系统的方法来识别、评估、响应和监控与其信息系统和资产相关的风险。")]),W,s("ul",null,[s("li",null,[a("问题修复脚本 "),n(o,{path:"/code/demo-scap-tools/try-openscap-01/fix.sh"})])]),H])}const as=d(F,[["render",Y],["__file","scap-implement-openscap-usage.html.vue"]]),ns=JSON.parse('{"path":"/zh/z-security-vulnerability/scap-implement-openscap-usage.html","title":"OpenSCAP 基本使用","lang":"zh-CN","frontmatter":{"title":"OpenSCAP 基本使用","date":"2024-04-13T00:00:00.000Z","tag":["scap","openscap"],"description":"OpenSCAP 是一个遵循 SCAP 标准的开源工具，目的是根据安全策略和配置文件评估本地系统的漏洞和标准配置。 OpenSCAP 支持基线核查（漏洞扫描/配置评估/合规性核查），报告和自动修复，目前主要有 Redhat 进行维护。 提示 为什么使用 OpenSCAP 做基线核查？ 完成度高 支持 SCAP 组件：检查项（CCE），检查方式（OVAL...","head":[["meta",{"property":"og:url","content":"https://lawsssscat.github.io/blog/zh/blog/zh/z-security-vulnerability/scap-implement-openscap-usage.html"}],["meta",{"property":"og:site_name","content":"个人博客"}],["meta",{"property":"og:title","content":"OpenSCAP 基本使用"}],["meta",{"property":"og:description","content":"OpenSCAP 是一个遵循 SCAP 标准的开源工具，目的是根据安全策略和配置文件评估本地系统的漏洞和标准配置。 OpenSCAP 支持基线核查（漏洞扫描/配置评估/合规性核查），报告和自动修复，目前主要有 Redhat 进行维护。 提示 为什么使用 OpenSCAP 做基线核查？ 完成度高 支持 SCAP 组件：检查项（CCE），检查方式（OVAL..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-05T13:20:39.000Z"}],["meta",{"property":"article:author","content":"Steven"}],["meta",{"property":"article:tag","content":"scap"}],["meta",{"property":"article:tag","content":"openscap"}],["meta",{"property":"article:published_time","content":"2024-04-13T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-05-05T13:20:39.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"OpenSCAP 基本使用\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-04-13T00:00:00.000Z\\",\\"dateModified\\":\\"2024-05-05T13:20:39.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Steven\\",\\"url\\":\\"https://github.com/LawssssCat/\\"}]}"]]},"headers":[{"level":2,"title":"基本功能","slug":"基本功能","link":"#基本功能","children":[{"level":3,"title":"执行工具和基线库","slug":"执行工具和基线库","link":"#执行工具和基线库","children":[]},{"level":3,"title":"扫描基线和扫描结果","slug":"扫描基线和扫描结果","link":"#扫描基线和扫描结果","children":[]},{"level":3,"title":"针对扫描结果进行修复","slug":"针对扫描结果进行修复","link":"#针对扫描结果进行修复","children":[]}]},{"level":2,"title":"组件","slug":"组件","link":"#组件","children":[{"level":3,"title":"OVAL 组件","slug":"oval-组件","link":"#oval-组件","children":[]},{"level":3,"title":"XCCDF 组件","slug":"xccdf-组件","link":"#xccdf-组件","children":[]}]},{"level":2,"title":"构成","slug":"构成","link":"#构成","children":[]}],"git":{"createdTime":1714833837000,"updatedTime":1714915239000,"contributors":[{"name":"lawsssscat","email":"18041500+LawssssCat@users.noreply.github.com","commits":2}]},"readingTime":{"minutes":7.18,"words":2154},"filePathRelative":"zh/z-security-vulnerability/scap-implement-openscap-usage.md","localizedDate":"2024年4月13日","excerpt":"<p><a href=\\"https://www.open-scap.org/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">OpenSCAP</a> 是一个遵循 SCAP 标准的开源工具，目的是根据安全策略和配置文件评估本地系统的漏洞和标准配置。\\nOpenSCAP 支持基线核查（漏洞扫描/配置评估/合规性核查），报告和自动修复，目前主要有 Redhat 进行维护。</p>\\n<div class=\\"hint-container tip\\">\\n<p class=\\"hint-container-title\\">提示</p>\\n<p>为什么使用 OpenSCAP 做基线核查？</p>\\n<ul>\\n<li>完成度高</li>\\n<li>支持 SCAP 组件：检查项（CCE），检查方式（OVAL）和基线标准化（PCI,STIG）等 NIST 和 MITRE 维护的美国政府或者行业标准</li>\\n<li>支持多种运行方式(bash/ansible/openscap)</li>\\n<li>支持问题修复</li>\\n<li>容易扩展，二次开发制作自定义的基线可用的高质量资源较多</li>\\n</ul>\\n</div>\\n","autoDesc":true}');export{as as comp,ns as data};
