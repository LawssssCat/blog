import{_ as g}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c,d as t,e as h,b as k,a as i,w as l,r,o,f as a}from"./app-yV4LJ0US.js";const A={};function y(m,s){const p=r("Tabs"),d=r("RepoLink");return o(),c("div",null,[s[8]||(s[8]=t(`<p>Makefile是<code>make</code>工具使用，用于描述工程如何构建的文件，从而进行源码的批量编译。</p><p>基本格式：</p><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">target</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> prerequisties</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">[tab键]command </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ⚠️command前需要使用tab键，而非空格xN</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># target： 目标文件，可以是ObjectFile、可执行文件、标签（Label，此概念将在“伪目标”中叙述）</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># prerequistie： 要生成那个target所需要的文件或者目标</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># command： 是make要执行的命令</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>基本执行流程：</p><ul><li><code>make</code>会在当前目录下找到一个名字叫<code>Makefile</code>或<code>makefile</code>的脚本文件</li><li>如果找到，他会找脚本文件中第一个目标（target），把目标实现，即生成目标文件 <ul><li>如果目标文件不存在，或者目标文件依赖的.o文件（prerequities）更新（即依赖文件修改时间比目标文件修改时间更新），则会执行目标（target）后面所定义的命令（command）来生成目标文件</li><li>如果目标文件依赖的.o文件（prerequities）不存在，则make会找到目标为该.o文件的规则，生成该.o文件，然后重新生成目标文件</li></ul></li></ul>`,5)),h(p,{id:"34",data:[{id:"构建命令"},{id:"Makefile"}]},{title0:l(({value:e,isActive:n})=>[...s[0]||(s[0]=[a("构建命令",-1)])]),title1:l(({value:e,isActive:n})=>[...s[1]||(s[1]=[a("Makefile",-1)])]),tab0:l(({value:e,isActive:n})=>[...s[2]||(s[2]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash","data-title":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"$"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," make"),i("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}}," # 构建")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"g++"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," -c"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," -g"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," -o"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," hello.o"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," hello.cc")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"g++"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," hello.o"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," -o"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," hello.out")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"chmod"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," +x"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," hello.out")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"$"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," ./hello.out")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"Hello,"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," VS"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Code!")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"$"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," make"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," clean"),i("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}}," # 清理")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"rm"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," -f"),i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E5C07B"}}," *"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},".o")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)])]),tab1:l(({value:e,isActive:n})=>[k(" markdownlint-disable MD010 "),s[3]||(s[3]=i("div",{class:"language-makefile line-numbers-mode","data-highlighter":"shiki","data-ext":"makefile","data-title":"makefile",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"hello"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},":"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#E06C75"}},"hello.o "),i("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}},"# 依赖hello.o文件，所以先执行它的命令")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#E5C07B"}},"	g++ hello.o -o hello.out")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#E5C07B"}},"	chmod +x hello.out")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"hello.o"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},":"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#E06C75"}},"hello.cc")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#E5C07B"}},"	g++ -c -g -o hello.o hello.cc")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"clean"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},":")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#E5C07B"}},"	rm -f *.o")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1)),k(" markdownlint-enable MD010 ")]),_:1}),k(" more "),s[9]||(s[9]=t(`<p>文档：</p><ul><li>GNU Make 官网网站： <a href="https://www.gnu.org/software/make/" target="_blank" rel="noopener noreferrer">https://www.gnu.org/software/make/</a></li><li>GNU Make 官方文档地址： <a href="https://www.gnu.org/software/make/manual/" target="_blank" rel="noopener noreferrer">https://www.gnu.org/software/make/manual/</a></li><li>Makefile Tutorial: <a href="https://makefiletutorial.com/" target="_blank" rel="noopener noreferrer">https://makefiletutorial.com/</a></li></ul><p>参考：</p><ul><li>[ ] B站|无限十三年|从零开始学Makefile - <a href="https://www.bilibili.com/video/BV1Bv4y1J7QT" target="_blank" rel="noopener noreferrer">https://www.bilibili.com/video/BV1Bv4y1J7QT</a> todo 看完+笔记</li></ul><h2 id="基本概念" tabindex="-1"><a class="header-anchor" href="#基本概念"><span>基本概念</span></a></h2><h3 id="伪目标" tabindex="-1"><a class="header-anchor" href="#伪目标"><span>伪目标</span></a></h3><p>“伪目标” 不是一个具体的文件，而是一个标签。</p><p>💡这个“伪目标”的取名不要和文件名重名，否则可能会不执行命令 为了避免和文件重名，可以添加特殊标记 <code>.PHONY</code> 来显式的指定一个目标为一个“伪目标”。</p><p>e.g.</p><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">clean</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">  @rm -rfv objs</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">debug</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">  @echo hello</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.PHONY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> clean</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="变量" tabindex="-1"><a class="header-anchor" href="#变量"><span>变量</span></a></h3><p>变量在声明时需要给予初始值，而且在使用时需要使用 <code>\${variable}</code>/<code>$(variable)</code> 格式。</p><p>e.g.</p><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> src/main.cpp</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">obj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> objs/main.o</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">obj</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> : </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">\${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">  @g++ -c </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -o </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">obj</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">compile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">obj</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>预定义变量/自动变量</h4><table><thead><tr><th>变量</th><th>说明</th></tr></thead><tbody><tr><td><code>$@</code></td><td>目标（target）的完整名称</td></tr><tr><td><code>$*</code></td><td>目标（target）的主干部分（即：不包括后缀）</td></tr><tr><td><code>$%</code></td><td>如果目标不是归档文件，则为空；<br>如果目标是归档文件成员，则为对应的成员文件名</td></tr><tr><td><code>$&lt;</code></td><td>第一个依赖文件（prerequisties）的名称</td></tr><tr><td><code>$^</code></td><td>所有的依赖文件（prerequisties）。用空格分开，不包含重复的依赖文件</td></tr><tr><td><code>$^</code></td><td>同 <code>$^</code> 但包含重复的文件名</td></tr><tr><td><code>$?</code></td><td>依赖中修改时间晚于目标修改时间的所有文件名。用空格分开</td></tr><tr><td>\`$</td><td>\`</td></tr></tbody></table><p>e.g.</p><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> src/main.cpp</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">obj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> objs/main.o</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">obj</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> : </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">\${</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">  @g++ -c </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$^</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -o </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$@</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">compile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">obj</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">clean</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">  @rm -rfv </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">obj</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.PHONY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> compile clean</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> compile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clean</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">removed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;objs/main.o&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>环境变量</h4><table><thead><tr><th>变量</th><th>说明</th></tr></thead><tbody><tr><td><code>MAKE</code></td><td>值：&quot;make&quot;</td></tr><tr><td><code>CURDIR</code></td><td>项目根路径</td></tr><tr><td><code>MAKECMDGOALS</code></td><td>命令行中输入的目标值</td></tr></tbody></table><h3 id="隐式变量名" tabindex="-1"><a class="header-anchor" href="#隐式变量名"><span>隐式变量名</span></a></h3><p>业界约定俗成的规则，如什么场景的变量一般用什么变量名。 <strong>但具体作用完全由makefile文件内容决定</strong>。</p><table><thead><tr><th>变量名</th><th>说明</th></tr></thead><tbody><tr><td><code>MAKEFLAGS</code></td><td><code>make -f1 -f2 ....</code> 中的 <code>-f1 -f2 -f3 ...</code></td></tr><tr><td><code>CC</code></td><td>指定C编译程序 <br> Program for compiling C programs; default gcc</td></tr><tr><td><code>CXX</code></td><td>指定C++编译程序 <br> Program for compiling C++ programs; default g++</td></tr><tr><td><code>CFLAGS</code></td><td>传递给C编译程序的额外参数 <br> Extra flags to give to the C compiler</td></tr><tr><td><code>CXXFLAGS</code></td><td>传递给C++编译程序的额外参数 <br> Extra flags to give to the C++ compiler</td></tr><tr><td><code>CPPFLAGS</code></td><td>传递给C处理器的额外参数 <br> Extra flags to give to the C preprocessor</td></tr><tr><td><code>LDFLAGS</code></td><td>传递给链接器的额外参数 <br> Extra flags to give to compiler when they are supposed to invoke the linker</td></tr></tbody></table><h4>变量范围</h4><p>Makefile中的变量一般时全局变量，也就是说定义后可以在Makefile中的任意位置使用。 但也可以将变量指定在某个目标范围内。</p><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">target</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ...</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> variable-assignment</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">target</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ...</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> prerequisites</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">  recipes</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">  ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>e.g.</p><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">var1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> Global Var</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">.c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> var2 = Some Target Var </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 全部 .c 目标能访问</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.PHONY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> test.c</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">test.c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> var3 = Specific Target Var </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 只有该目标能访问</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">test.c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">  @echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">var1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">  @echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">var2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">  @echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">var3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="常用符号" tabindex="-1"><a class="header-anchor" href="#常用符号"><span>常用符号</span></a></h3><h4><code>=</code> 链接</h4><ul><li>链接赋值运算符</li><li>用于将右边的值分配给左边的变量</li><li><strong>如果后面的语句重新定义了该变量，则将使用新的值</strong></li></ul><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> aarch64</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 改变变量值</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> amd64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">debug</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">  @echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # amd64</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4><code>:=</code> 赋值</h4><ul><li>立即赋值运算</li><li>用于在定义变量时立即求值</li><li>该值在定义后不再更改</li><li>即使在后面的语句中重新定义了该变量</li></ul><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> aarch64</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 改变变量值</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> amd64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">debug</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">  @echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">TARGET_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # aarch64</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4><code>?=</code> 默认</h4><ul><li>默认赋值运算符</li><li>如果该变量已经定义，则不进行任何操作</li><li>如果该变量尚未定义，则求值并分配</li></ul><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> aarch64</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   ?=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> amd64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">debug</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">  @echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">HOST_ARCH</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # aarch64</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4><code>+=</code> 累加</h4><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CXXFLAGS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -m64 -fPIC -g -O0 -std=c++11 -w -fopenmp</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CXXFLAGS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> +=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">include_paths</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4><code>\\</code> 续行</h4><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">LDLIBS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> cudart opencv_core </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">          gomp nvinfer protobuf cudnn pthread </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">          cublas nvcaffe_parser nvinfer_plugin</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="常用函数" tabindex="-1"><a class="header-anchor" href="#常用函数"><span>常用函数</span></a></h3><p>语法： <code>$(fn arguments)</code> or <code>\${fn arguments}</code></p><ul><li><code>fn</code> 函数名</li><li><code>arguments</code> 函数参数 <ul><li>函数名与参数间以空格 <code></code> 分割</li><li>参数间以逗号 <code>,</code> 分割</li></ul></li></ul><h4>shell</h4><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;command&gt; &lt;arguments&gt;)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 功能： 调用 shell 命令</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 返回： 函数返回 shell 命令执行结果</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>e.g.</p><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find src -name &quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp&quot;)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4>subst</h4><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">subst</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;from&gt;,&lt;to&gt;,&lt;text&gt;)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 功能： 字符串替换函数。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#       把 &lt;text&gt; 中的 &lt;from&gt; 替换成 &lt;to&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 返回： 替换结果</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find src -name &quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp&quot;)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_objs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">subst</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> src/,objs/,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4>patsubst</h4><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">patsubst</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;pattern&gt;,&lt;replacement&gt;,&lt;text&gt;)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 功能： 模式字符串替换函数。 </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#       从 &lt;text&gt; 中 &lt;pattern&gt; 替换成 &lt;replacement&gt; </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#       支持通配符% —— 表示任意长度的字符串</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find src -name &quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp&quot;)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_objs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">patsubst</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp,objs/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.o,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4>foreach</h4><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">foreach</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;var&gt;,&lt;list&gt;,&lt;text&gt;)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 功能： 循环函数。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#        把字符串 &lt;list&gt; 中的元素逐一去除，执行 &lt;text&gt; 包含的表达式</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 返回： &lt;text&gt; 所返回的每个字符串组成的字符串（以空格分割）</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 伪代码（python）</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># res = &quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># for var in list:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#   res = res + &quot; &quot; + text + var</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">library_paths</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> /datav/shared/100_du/03.08/lean/protobuf-3.11.4/lib </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">                 /usr/local/cuda-10.1/lib64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">library_paths</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">foreach</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> item,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">library_paths</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">),-L$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">item</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 结果：</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># g++ *.cpp -o main -L/datav/shared/100_du/03.08/lean/protobuf-3.11.4/lib -L/usr/local/cuda-10.1/lib64 -L...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>同等效果</p><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">I_flag</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">I_flag:%=-I%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4>dir</h4><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;names...&gt;)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 功能： 取目录函数。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#       从文件名序列中取出目录部分。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#       目录部分是指最后一个反斜杠 &quot;/&quot; 之前的部分</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#       如果没有反斜杠，则返回 &quot;./&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 返回： 返回文件名序列的目录部分</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> src/foo.c hacks)</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 返回值 &quot;src/ ./&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find src -name &quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp&quot;)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_objs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">patsubst</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.cpp,objs/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.o,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">objs/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">.o</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> src/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">.cpp</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">  @mkdir -p </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">dir</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> $@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 创建目录</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">  @g++ -c </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$^</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -o </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$@</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">compile</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_objs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">debug</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">  @echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_srcs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">  @echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cpp_objs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.PHONY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> debug compile</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>notdir</h4><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">notdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;names...&gt;)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">libs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">notdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find /usr/lib -name lib</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4>filter/filter-out</h4><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">filter</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;names...&gt;)</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 包含</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">filter-out</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;names...&gt;)</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 排除</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">libs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">notdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find /usr/lib -name lib</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">a_libs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">filter</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> %</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.a,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">libs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">so_libs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">filter</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> %</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.so,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">libs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>basename</h4><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">basename</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;names...&gt;)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">libs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">notdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find /usr/lib -name lib</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">a_libs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">subst</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lib,$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">basename</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">filter</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> %</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.a,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">libs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))))</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">so_libs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">subst</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lib,$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">basename</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">filter</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> %</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.so,$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">libs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">))))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>origin</h4><p>返回变量出处</p><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ifeq</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> (&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">origin</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">&quot;, &quot;command line&quot;)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  KBUILD_EXTMOD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">endif</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># command line</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># file</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>if</h4><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#if 函数的语法是:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#$(if &lt;condition&gt;,&lt;then-part&gt; )</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#或</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#$(if &lt;condition&gt;,&lt;then-part&gt;,&lt;else-part&gt; )</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#&lt;condition&gt;参数是if的表达式，如果其返回的为非空字符串，那么这个表达式就相当于返回真，于是，&lt;then-part&gt;会被计算，否则&lt;else-part&gt;会被计算</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#if函数的返回值是，</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#     如果&lt;condition&gt;为真（非空字符串），那个&lt;then-part&gt;会是整个函数的返回值，</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#     如果&lt;condition&gt;为假（空字符串），那么&lt;else-part&gt;会是整个函数的返回值，此时如果&lt;else-part&gt;没有被定义，那么，整个函数返回空字串。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">SRC_DIR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> src</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#if函数---设置默认值</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#如果变量SRC_DIR的值不为空,则将SRC_DIR指定的目录作为SUBDIR子目录;否则将/home/src作为子目录</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">SUBDIR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> +=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">if</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">SRC_DIR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">),$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">SRC_DIR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">),/home/src)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">all</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">    @echo </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">SUBDIR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 例子：</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">KBUILD_OUTPUT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> :=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">shell</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cd $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">KBUILD_OUTPUT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">) &amp;&amp; /bin/pwd)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">if</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">KBUILD_OUTPUT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">),, </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     $(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">error</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> output directory &quot;$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">saved-output</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)&quot; does not exist))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="逻辑判断" tabindex="-1"><a class="header-anchor" href="#逻辑判断"><span>逻辑判断</span></a></h3><p>是否定义</p><div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ifdef</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> V</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  ifeq</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> (&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">origin</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> V</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">&quot;, &quot;command line&quot;)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    KBUILD_VERBOSE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">V</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  endif</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">endif</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ifndef</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> KBUILD_VERBOSE</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  KBUILD_VERBOSE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> 0</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">endif</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>是否相等</p>`,83)),k(" markdownlint-disable MD010 "),s[10]||(s[10]=t(`<div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">defconfig</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> $(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">obj</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">/conf</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ifeq</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> (</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">KBUILD_DEFCONFIG</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">,)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">	$&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -d Config.in</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	@</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">echo *** Default configuration is based on &#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">KBUILD_DEFCONFIG</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Q</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">$&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> -D </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">KBUILD_DEFCONFIG</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> Config.in</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">endif</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	$(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">MTIME_IS_COARSE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> &amp;&amp; sleep 1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1)),k(" markdownlint-enable MD010 "),s[11]||(s[11]=t('<h2 id="kbuild-kconfig" tabindex="-1"><a class="header-anchor" href="#kbuild-kconfig"><span>kbuild/kconfig</span></a></h2><p>todo</p><p>Menuconfig配置原理： 在Linux里面我们所看到的menuconfig界面是通过配置内核顶层的Kconfig产生的，而当输入make menuconfig命令的时候系统会读取Makefile来解析Kconfig。</p><h2 id="例子" tabindex="-1"><a class="header-anchor" href="#例子"><span>例子</span></a></h2><h3 id="例子-编译参数链接-问题-解决缺少头文件问题" tabindex="-1"><a class="header-anchor" href="#例子-编译参数链接-问题-解决缺少头文件问题"><span>例子：编译参数链接/问题：解决缺少头文件问题</span></a></h3><p>代码：</p>',6)),h(d,{path:"/code/code/demo-c-base/demo-02-makefile/demo-make-03/Makefile-fail-01-header"}),h(p,{id:"516",data:[{id:"错误：缺少头文件路径参数"},{id:"正确"}]},{title0:l(({value:e,isActive:n})=>[...s[4]||(s[4]=[a("错误：缺少头文件路径参数",-1)])]),title1:l(({value:e,isActive:n})=>[...s[5]||(s[5]=[a("正确",-1)])]),tab0:l(({value:e,isActive:n})=>[...s[6]||(s[6]=[i("div",{class:"language-bash line-numbers-mode","data-highlighter":"shiki","data-ext":"bash","data-title":"bash",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"$"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," make"),i("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}}," # 缺失头文件问题")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"src/add.cpp:1:10:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," fatal"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," error:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," add.hpp:"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," No"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," such"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," file"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," or"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," directory")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"    1"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," | "),i("span",{style:{"--shiki-light":"#A0A1A7","--shiki-light-font-style":"italic","--shiki-dark":"#7F848E","--shiki-dark-font-style":"italic"}},"#include <add.hpp>")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"      |          "),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"^~~~~~~~~")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"compilation"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," terminated.")]),a(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"make:"),i("span",{style:{"--shiki-light":"#E45649","--shiki-dark":"#E5C07B"}}," ***"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," [Makefile:6: "),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}},"objs/add.o]"),i("span",{style:{"--shiki-light":"#50A14F","--shiki-dark":"#98C379"}}," Error"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}}," 1")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"}),i("div",{class:"line-number"})])],-1),i("div",{class:"language-java line-numbers-mode","data-highlighter":"shiki","data-ext":"java","data-title":"java",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}},"<!"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"--"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," @"),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#E5C07B"}},"include"),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#C678DD"}},":"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}}," @"),i("span",{style:{"--shiki-light":"#A626A4","--shiki-dark":"#E5C07B"}},"project"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}},"/"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#E06C75"}},"code"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}},"/"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#E06C75"}},"demo"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}},"-"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#E06C75"}},"c"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}},"-"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#E06C75"}},"base"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}},"/"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#E06C75"}},"demo"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}},"-"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"02"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}},"-"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#E06C75"}},"makefile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}},"/"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#E06C75"}},"demo"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}},"-"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#E06C75"}},"make"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}},"-"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"03"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}},"/"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#E06C75"}},"Makefile"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}},"-"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#E06C75"}},"fail"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}},"-"),i("span",{style:{"--shiki-light":"#986801","--shiki-dark":"#D19A66"}},"01"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}},"-"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#E06C75"}},"header "),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},"--"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#56B6C2"}},">")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),tab1:l(({value:e,isActive:n})=>[...s[7]||(s[7]=[i("div",{class:"language-makefile line-numbers-mode","data-highlighter":"shiki","data-ext":"makefile","data-title":"makefile",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[i("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}},"<!--"),i("span",{style:{"--shiki-light":"#4078F2","--shiki-dark":"#61AFEF"}}," @include"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#ABB2BF"}},":"),i("span",{style:{"--shiki-light":"#383A42","--shiki-dark":"#E06C75"}}," @project/code/demo-c-base/demo-02-makefile/demo-make-03/Makefile -->")])])]),i("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[i("div",{class:"line-number"})])],-1)])]),_:1}),s[12]||(s[12]=i("h3",{id:"例子-静态库编译",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#例子-静态库编译"},[i("span",null,"例子：静态库编译")])],-1)),s[13]||(s[13]=i("p",null,"代码：",-1)),h(d,{path:"/code/code/demo-c-base/demo-02-makefile/demo-make-03/Makefile-staticlib"}),s[14]||(s[14]=t('<div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&lt;!--</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> @include</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> @project/code/demo-c-base/demo-02-makefile/demo-make-03/Makefile-staticlib --&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="例子-动态库编译" tabindex="-1"><a class="header-anchor" href="#例子-动态库编译"><span>例子：动态库编译</span></a></h3><p>代码：</p>',3)),h(d,{path:"/code/code/demo-c-base/demo-02-makefile/demo-make-03/Makefile-dynamiclib"}),s[15]||(s[15]=t('<div class="language-makefile line-numbers-mode" data-highlighter="shiki" data-ext="makefile" data-title="makefile" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&lt;!--</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> @include</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> @project/code/demo-c-base/demo-02-makefile/demo-make-03/Makefile-dynamiclib --&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="例子-嵌套编译" tabindex="-1"><a class="header-anchor" href="#例子-嵌套编译"><span>例子：嵌套编译</span></a></h3><p>大项目中会分出多个小项目，这时需要使用嵌套（递归）make构建。</p><p>具体做法为：</p><ol><li>每个子项目都写一个Makefile</li><li>写一个总的Makefile调用各子项目Makefile</li></ol><p>e.g.</p><p>将main.cpp外的其他cpp存为一个子项目，编译为一个库文件。然后将main.cpp作为另一个子项目，编译为.o文件。最后再链接库文件成可执行文件。</p><p>todo 完成例子</p>',8))])}const u=g(A,[["render",y]]),F=JSON.parse('{"path":"/zh/dev-c-commonsense/makefile.html","title":"Makefile 使用笔记","lang":"zh-CN","frontmatter":{"title":"Makefile 使用笔记","order":11,"description":"Makefile是make工具使用，用于描述工程如何构建的文件，从而进行源码的批量编译。 基本格式： 基本执行流程： make会在当前目录下找到一个名字叫Makefile或makefile的脚本文件 如果找到，他会找脚本文件中第一个目标（target），把目标实现，即生成目标文件 如果目标文件不存在，或者目标文件依赖的.o文件（prerequities...","head":[["meta",{"property":"og:url","content":"https://lawsssscat.github.io/blog/zh/blog/zh/dev-c-commonsense/makefile.html"}],["meta",{"property":"og:site_name","content":"个人博客"}],["meta",{"property":"og:title","content":"Makefile 使用笔记"}],["meta",{"property":"og:description","content":"Makefile是make工具使用，用于描述工程如何构建的文件，从而进行源码的批量编译。 基本格式： 基本执行流程： make会在当前目录下找到一个名字叫Makefile或makefile的脚本文件 如果找到，他会找脚本文件中第一个目标（target），把目标实现，即生成目标文件 如果目标文件不存在，或者目标文件依赖的.o文件（prerequities..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-09-21T17:28:04.000Z"}],["meta",{"property":"article:modified_time","content":"2025-09-21T17:28:04.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Makefile 使用笔记\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-09-21T17:28:04.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Steven\\",\\"url\\":\\"https://github.com/LawssssCat/\\"}]}"]]},"headers":[{"level":2,"title":"基本概念","slug":"基本概念","link":"#基本概念","children":[{"level":3,"title":"伪目标","slug":"伪目标","link":"#伪目标","children":[]},{"level":3,"title":"变量","slug":"变量","link":"#变量","children":[{"level":4,"title":"预定义变量/自动变量","slug":"预定义变量-自动变量","link":"#预定义变量-自动变量","children":[]},{"level":4,"title":"环境变量","slug":"环境变量","link":"#环境变量","children":[]}]},{"level":3,"title":"隐式变量名","slug":"隐式变量名","link":"#隐式变量名","children":[{"level":4,"title":"变量范围","slug":"变量范围","link":"#变量范围","children":[]}]},{"level":3,"title":"常用符号","slug":"常用符号","link":"#常用符号","children":[{"level":4,"title":"= 链接","slug":"链接","link":"#链接","children":[]},{"level":4,"title":":= 赋值","slug":"赋值","link":"#赋值","children":[]},{"level":4,"title":"?= 默认","slug":"默认","link":"#默认","children":[]},{"level":4,"title":"+= 累加","slug":"累加","link":"#累加","children":[]},{"level":4,"title":"\\\\ 续行","slug":"续行","link":"#续行","children":[]}]},{"level":3,"title":"常用函数","slug":"常用函数","link":"#常用函数","children":[{"level":4,"title":"shell","slug":"shell","link":"#shell","children":[]},{"level":4,"title":"subst","slug":"subst","link":"#subst","children":[]},{"level":4,"title":"patsubst","slug":"patsubst","link":"#patsubst","children":[]},{"level":4,"title":"foreach","slug":"foreach","link":"#foreach","children":[]},{"level":4,"title":"dir","slug":"dir","link":"#dir","children":[]},{"level":4,"title":"notdir","slug":"notdir","link":"#notdir","children":[]},{"level":4,"title":"filter/filter-out","slug":"filter-filter-out","link":"#filter-filter-out","children":[]},{"level":4,"title":"basename","slug":"basename","link":"#basename","children":[]},{"level":4,"title":"origin","slug":"origin","link":"#origin","children":[]},{"level":4,"title":"if","slug":"if","link":"#if","children":[]}]},{"level":3,"title":"逻辑判断","slug":"逻辑判断","link":"#逻辑判断","children":[]}]},{"level":2,"title":"kbuild/kconfig","slug":"kbuild-kconfig","link":"#kbuild-kconfig","children":[]},{"level":2,"title":"例子","slug":"例子","link":"#例子","children":[{"level":3,"title":"例子：编译参数链接/问题：解决缺少头文件问题","slug":"例子-编译参数链接-问题-解决缺少头文件问题","link":"#例子-编译参数链接-问题-解决缺少头文件问题","children":[]},{"level":3,"title":"例子：静态库编译","slug":"例子-静态库编译","link":"#例子-静态库编译","children":[]},{"level":3,"title":"例子：动态库编译","slug":"例子-动态库编译","link":"#例子-动态库编译","children":[]},{"level":3,"title":"例子：嵌套编译","slug":"例子-嵌套编译","link":"#例子-嵌套编译","children":[]}]}],"git":{"createdTime":1758464566000,"updatedTime":1758475684000,"contributors":[{"name":"lawsssscat","username":"lawsssscat","email":"18041500+LawssssCat@users.noreply.github.com","commits":3,"url":"https://github.com/lawsssscat"}]},"readingTime":{"minutes":7.83,"words":2348},"filePathRelative":"zh/dev-c-commonsense/makefile.md","localizedDate":"2025年9月21日","excerpt":"<p>Makefile是<code>make</code>工具使用，用于描述工程如何构建的文件，从而进行源码的批量编译。</p>\\n<p>基本格式：</p>\\n<div class=\\"language-makefile line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"makefile\\" data-title=\\"makefile\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">target</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> :</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#E06C75\\"> prerequisties</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#E5C07B\\">[tab键]command </span><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># ⚠️command前需要使用tab键，而非空格xN</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># target： 目标文件，可以是ObjectFile、可执行文件、标签（Label，此概念将在“伪目标”中叙述）</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># prerequistie： 要生成那个target所需要的文件或者目标</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># command： 是make要执行的命令</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div><p>基本执行流程：</p>\\n<ul>\\n<li><code>make</code>会在当前目录下找到一个名字叫<code>Makefile</code>或<code>makefile</code>的脚本文件</li>\\n<li>如果找到，他会找脚本文件中第一个目标（target），把目标实现，即生成目标文件\\n<ul>\\n<li>如果目标文件不存在，或者目标文件依赖的.o文件（prerequities）更新（即依赖文件修改时间比目标文件修改时间更新），则会执行目标（target）后面所定义的命令（command）来生成目标文件</li>\\n<li>如果目标文件依赖的.o文件（prerequities）不存在，则make会找到目标为该.o文件的规则，生成该.o文件，然后重新生成目标文件</li>\\n</ul>\\n</li>\\n</ul>\\n\\n","autoDesc":true}');export{u as comp,F as data};
