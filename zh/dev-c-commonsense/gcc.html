<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.19" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.66" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://lawsssscat.github.io/blog/zh/blog/zh/dev-c-commonsense/gcc.html"><meta property="og:site_name" content="个人博客"><meta property="og:title" content="GCC 使用笔记"><meta property="og:description" content="GCC（GNU Compiler Collection，GNU编译程序集合）是GNU项目的一个开放源码产品。 GCC是一套编译器工具集，支持多种编程语言，包括C、C++、Objective-C、Fortran、Ada、Go和D等。如Python就是由C语言开发，由GNU编译程序编译的！ GCC官网地址： https://gcc.gnu.org/ GCC..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-10-06T03:09:14.000Z"><meta property="article:modified_time" content="2025-10-06T03:09:14.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"GCC 使用笔记","image":[""],"dateModified":"2025-10-06T03:09:14.000Z","author":[{"@type":"Person","name":"Steven","url":"https://github.com/LawssssCat/"}]}</script><title>GCC 使用笔记 | 个人博客</title><meta name="description" content="GCC（GNU Compiler Collection，GNU编译程序集合）是GNU项目的一个开放源码产品。 GCC是一套编译器工具集，支持多种编程语言，包括C、C++、Objective-C、Fortran、Ada、Go和D等。如Python就是由C语言开发，由GNU编译程序编译的！ GCC官网地址： https://gcc.gnu.org/ GCC...">
    <link rel="preload" href="/blog/assets/style-DQbojaOW.css" as="style"><link rel="stylesheet" href="/blog/assets/style-DQbojaOW.css">
    <link rel="modulepreload" href="/blog/assets/app-DY6veuwS.js"><link rel="modulepreload" href="/blog/assets/gcc.html-kgCNRgKs.js"><link rel="modulepreload" href="/blog/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/blog/assets/index.html-CqICrM6k.js" as="script"><link rel="prefetch" href="/blog/assets/changelog.html-D6rIxKVI.js" as="script"><link rel="prefetch" href="/blog/assets/intro.html-BVaRmpZV.js" as="script"><link rel="prefetch" href="/blog/assets/router.html-BbGIkX52.js" as="script"><link rel="prefetch" href="/blog/assets/tools.html-CnZow5b1.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DVlAj57O.js" as="script"><link rel="prefetch" href="/blog/assets/basic-syntax.html-aCPQR7KV.js" as="script"><link rel="prefetch" href="/blog/assets/cmake.html-DBKJBEMq.js" as="script"><link rel="prefetch" href="/blog/assets/gdb.html-DgExFYx5.js" as="script"><link rel="prefetch" href="/blog/assets/makefile.html-BnY7v1r6.js" as="script"><link rel="prefetch" href="/blog/assets/mingw.html-SyP5By07.js" as="script"><link rel="prefetch" href="/blog/assets/msvc.html-DIibqdgN.js" as="script"><link rel="prefetch" href="/blog/assets/posix.html-UpQAvJaj.js" as="script"><link rel="prefetch" href="/blog/assets/vcpkg.html-C4Y9uzO6.js" as="script"><link rel="prefetch" href="/blog/assets/array.html-L3L0czZN.js" as="script"><link rel="prefetch" href="/blog/assets/graph.html-C1yaJ340.js" as="script"><link rel="prefetch" href="/blog/assets/tree.html-D9NlncOq.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-B-RJz9Cw.js" as="script"><link rel="prefetch" href="/blog/assets/gradle.html-D7U_wgiT.js" as="script"><link rel="prefetch" href="/blog/assets/maven-commands.html-BRlLHK8C.js" as="script"><link rel="prefetch" href="/blog/assets/maven-introduction.html-DjvPF7gC.js" as="script"><link rel="prefetch" href="/blog/assets/maven-plugins-list.html-bpcYd2lk.js" as="script"><link rel="prefetch" href="/blog/assets/maven-plugins.html-DJvsjINT.js" as="script"><link rel="prefetch" href="/blog/assets/maven-repository-self.html-8m2cgywD.js" as="script"><link rel="prefetch" href="/blog/assets/maven-repository-settings.html-D-fUwz1D.js" as="script"><link rel="prefetch" href="/blog/assets/maven-settings.html-DkXcqQi0.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-7h_e75iY.js" as="script"><link rel="prefetch" href="/blog/assets/jdk-collection.html-DvejWtPZ.js" as="script"><link rel="prefetch" href="/blog/assets/jdk-httpclient.html-BiA78DgZ.js" as="script"><link rel="prefetch" href="/blog/assets/jdk-io-jar.html-ClSFrNwF.js" as="script"><link rel="prefetch" href="/blog/assets/jdk-io.html-6CiOl96v.js" as="script"><link rel="prefetch" href="/blog/assets/jdk-jvm.html-DxieFu74.js" as="script"><link rel="prefetch" href="/blog/assets/jdk-serialize-with-fastjson2.html-C_gm0Q8f.js" as="script"><link rel="prefetch" href="/blog/assets/jdk-serialize-with-jackson.html-CskRCkLF.js" as="script"><link rel="prefetch" href="/blog/assets/jdk-serialize.html-DHjzU-iW.js" as="script"><link rel="prefetch" href="/blog/assets/jdk-thread.html-D_a0TldQ.js" as="script"><link rel="prefetch" href="/blog/assets/jdk-validation-with-spring.html-DVdP-bs-.js" as="script"><link rel="prefetch" href="/blog/assets/jdk-validation.html-l-_BX5An.js" as="script"><link rel="prefetch" href="/blog/assets/jdk-web.html-BIAej0AL.js" as="script"><link rel="prefetch" href="/blog/assets/rules.html-kSE910JW.js" as="script"><link rel="prefetch" href="/blog/assets/sdk-compile-lombok.html-CB_XMMmF.js" as="script"><link rel="prefetch" href="/blog/assets/sdk-script-groovy.html-CgNgaUxE.js" as="script"><link rel="prefetch" href="/blog/assets/sdk-toolkit-guava.html-k5qZSEtz.js" as="script"><link rel="prefetch" href="/blog/assets/tool-class2exe.html-B7LHmYp8.js" as="script"><link rel="prefetch" href="/blog/assets/tool-debug.html-atycVnwx.js" as="script"><link rel="prefetch" href="/blog/assets/tool-jdk-version.html-BA6XC6So.js" as="script"><link rel="prefetch" href="/blog/assets/introduction.html-BirusC0R.js" as="script"><link rel="prefetch" href="/blog/assets/jdbc-h2.html-0oxl7ylu.js" as="script"><link rel="prefetch" href="/blog/assets/jdbc-mybatis-pagehelper.html-Dt9YEIvn.js" as="script"><link rel="prefetch" href="/blog/assets/jdbc-mybatis-tk_mapper.html-DG-NpwiC.js" as="script"><link rel="prefetch" href="/blog/assets/jdbc-mybatis.html-Bcps3JO3.js" as="script"><link rel="prefetch" href="/blog/assets/tools-keygenerator.html-D9H7hgJ0.js" as="script"><link rel="prefetch" href="/blog/assets/introduction.html-_F22qyI7.js" as="script"><link rel="prefetch" href="/blog/assets/introduction.html-DOebObVe.js" as="script"><link rel="prefetch" href="/blog/assets/log4j-old.html-DLYIgg-4.js" as="script"><link rel="prefetch" href="/blog/assets/slf4j-log4j2.html-D63SSdaz.js" as="script"><link rel="prefetch" href="/blog/assets/slf4j-logback.html-BW6Cz0ET.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CNPN9lKm.js" as="script"><link rel="prefetch" href="/blog/assets/excel-easyexcel.html-CQLmSE8s.js" as="script"><link rel="prefetch" href="/blog/assets/excel-poi.html-olXY_Cgy.js" as="script"><link rel="prefetch" href="/blog/assets/introduction.html-DRcv5Vep.js" as="script"><link rel="prefetch" href="/blog/assets/introduction.html-BnK7ioDo.js" as="script"><link rel="prefetch" href="/blog/assets/quartz.html-Yh8QEl0S.js" as="script"><link rel="prefetch" href="/blog/assets/springboot_schedule.html-88wzHbOf.js" as="script"><link rel="prefetch" href="/blog/assets/timer.html-DRD5sMdS.js" as="script"><link rel="prefetch" href="/blog/assets/certificate-management.html-BA8eY7Ph.js" as="script"><link rel="prefetch" href="/blog/assets/introduction.html-WsShCjxZ.js" as="script"><link rel="prefetch" href="/blog/assets/jwt-jjwt.html-BaTfQj22.js" as="script"><link rel="prefetch" href="/blog/assets/rasp.html-DukDnHzt.js" as="script"><link rel="prefetch" href="/blog/assets/sasl.html-Bj2XAgWz.js" as="script"><link rel="prefetch" href="/blog/assets/shiro.html-DWFUYuGt.js" as="script"><link rel="prefetch" href="/blog/assets/spring-security.html-Dme3Ly-s.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-B_f3xWLD.js" as="script"><link rel="prefetch" href="/blog/assets/netty.html-CzrLrqr3.js" as="script"><link rel="prefetch" href="/blog/assets/socket-native.html-D7GB5zzd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DaDimvoz.js" as="script"><link rel="prefetch" href="/blog/assets/spring-spel.html-BnWonIZA.js" as="script"><link rel="prefetch" href="/blog/assets/spring.html-Dm20uFgC.js" as="script"><link rel="prefetch" href="/blog/assets/kafka.html-DiPP28mE.js" as="script"><link rel="prefetch" href="/blog/assets/springcloud-alibaba.html-Be2QqgXJ.js" as="script"><link rel="prefetch" href="/blog/assets/mockito.html-DG0-0HfC.js" as="script"><link rel="prefetch" href="/blog/assets/wiremock.html-BsUmnWVT.js" as="script"><link rel="prefetch" href="/blog/assets/introduction.html-R7K_9f-9.js" as="script"><link rel="prefetch" href="/blog/assets/usage-digester.html-9_Vjrg6g.js" as="script"><link rel="prefetch" href="/blog/assets/usage-dom.html-DxZTDHga.js" as="script"><link rel="prefetch" href="/blog/assets/usage-dom4j.html-Duyj4NsT.js" as="script"><link rel="prefetch" href="/blog/assets/usage-jaxb.html-DXj9UJkp.js" as="script"><link rel="prefetch" href="/blog/assets/usage-jdom.html-JNHIXO-n.js" as="script"><link rel="prefetch" href="/blog/assets/usage-sax.html-DsHz0D5g.js" as="script"><link rel="prefetch" href="/blog/assets/usage-springoxm.html-D-5UfJlx.js" as="script"><link rel="prefetch" href="/blog/assets/usage-xstream.html-boiLmiHz.js" as="script"><link rel="prefetch" href="/blog/assets/xpath.html-Yt5bIdeu.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BrdaiNLx.js" as="script"><link rel="prefetch" href="/blog/assets/css.html-C3x02Mr8.js" as="script"><link rel="prefetch" href="/blog/assets/feature-screen.html-DEaKVBIX.js" as="script"><link rel="prefetch" href="/blog/assets/js-drag-native.html-B3qrDdLY.js" as="script"><link rel="prefetch" href="/blog/assets/js.html-S7FysHei.js" as="script"><link rel="prefetch" href="/blog/assets/lodash.html-BF8F7cLQ.js" as="script"><link rel="prefetch" href="/blog/assets/svg.html-AYmVVHBW.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Dwp-Qy6m.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BHCdsE9j.js" as="script"><link rel="prefetch" href="/blog/assets/antv-g6.html-D1MQVe7R.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-7T8x_KFr.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-qRAptdkx.js" as="script"><link rel="prefetch" href="/blog/assets/package.html-CNj3gAAJ.js" as="script"><link rel="prefetch" href="/blog/assets/third.html-D0PluWpN.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-4doqwGva.js" as="script"><link rel="prefetch" href="/blog/assets/idl-syntax.html-BZXX6D-m.js" as="script"><link rel="prefetch" href="/blog/assets/introduction.html-D-WmvLAy.js" as="script"><link rel="prefetch" href="/blog/assets/network-model.html-BOsjyb2K.js" as="script"><link rel="prefetch" href="/blog/assets/usage.html-4u8SLTX7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html--CxnGj4B.js" as="script"><link rel="prefetch" href="/blog/assets/complication-lv5.html-KVPEOptj.js" as="script"><link rel="prefetch" href="/blog/assets/complication.html-VXtPTEUI.js" as="script"><link rel="prefetch" href="/blog/assets/getstart.html-OcUGCnYt.js" as="script"><link rel="prefetch" href="/blog/assets/roadmap.html-DsnyipJt.js" as="script"><link rel="prefetch" href="/blog/assets/syntax.html-DomnYNef.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Dz8EPg4g.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-qQk0m_b9.js" as="script"><link rel="prefetch" href="/blog/assets/demand-analysis.html-vA-2AO0M.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Q-3Oa096.js" as="script"><link rel="prefetch" href="/blog/assets/staruml.html-Dck-o4ag.js" as="script"><link rel="prefetch" href="/blog/assets/introduction.html-BNCRiU_Z.js" as="script"><link rel="prefetch" href="/blog/assets/plugin.html-DDtH6aMf.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Y756pnR-.js" as="script"><link rel="prefetch" href="/blog/assets/introduction.html-DS7UIp5U.js" as="script"><link rel="prefetch" href="/blog/assets/podman.html-DYufAIoq.js" as="script"><link rel="prefetch" href="/blog/assets/usage.html-CiMig1Bo.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-GFmJj6r6.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DV-g8IaH.js" as="script"><link rel="prefetch" href="/blog/assets/config.html-D8t8b-VS.js" as="script"><link rel="prefetch" href="/blog/assets/deployment.html-DeJ3Jzzp.js" as="script"><link rel="prefetch" href="/blog/assets/usage.html-CwkQyVYa.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BsIBpUYC.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DY1whqoi.js" as="script"><link rel="prefetch" href="/blog/assets/vagrant.html-DAdxpWTW.js" as="script"><link rel="prefetch" href="/blog/assets/wsl.html-BfFFyfts.js" as="script"><link rel="prefetch" href="/blog/assets/tricks.html-W4FnFvK7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Cjl71ASg.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ohwUvycV.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Ce30pb8a.js" as="script"><link rel="prefetch" href="/blog/assets/x11.html-DlTHFwTW.js" as="script"><link rel="prefetch" href="/blog/assets/zsh.html-CZNJ7PWy.js" as="script"><link rel="prefetch" href="/blog/assets/func-game.html-w2rK9MEf.js" as="script"><link rel="prefetch" href="/blog/assets/nor-certificate.html-CbDTshW0.js" as="script"><link rel="prefetch" href="/blog/assets/nor-trans-car.html-Bd5m7kNg.js" as="script"><link rel="prefetch" href="/blog/assets/blockchain-introduction.html-Dvm5JWgL.js" as="script"><link rel="prefetch" href="/blog/assets/ethereum-introduction.html-Bio_9iJl.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-D2d3y9iX.js" as="script"><link rel="prefetch" href="/blog/assets/scap-implement-openscap-usage.html-C-VLgWGA.js" as="script"><link rel="prefetch" href="/blog/assets/scap-implement-tool.html-iKKeXv_w.js" as="script"><link rel="prefetch" href="/blog/assets/vulnerable-management-introduction.html-C9v3yCrV.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BeI41vIv.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DmTPxYHH.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CfEMlnNN.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BBf3Ssno.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-B4CJbGCx.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-C5d18YHi.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BbOHtHhY.js" as="script"><link rel="prefetch" href="/blog/assets/clang.html-BXdF73zt.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BbPaZwom.js" as="script"><link rel="prefetch" href="/blog/assets/jdk16-recordtype.html-CbaV3Ry7.js" as="script"><link rel="prefetch" href="/blog/assets/jdk21-patternmatching.html-CKRBTcW0.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BbpW-PKt.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Dt_FqvRv.js" as="script"><link rel="prefetch" href="/blog/assets/ruoyi-cloud.html-BRdWeLIl.js" as="script"><link rel="prefetch" href="/blog/assets/ruoyi-vue.html-BhygWz9K.js" as="script"><link rel="prefetch" href="/blog/assets/ruoyi.html-ELOh5M_P.js" as="script"><link rel="prefetch" href="/blog/assets/introduction.html-CUyEEzxZ.js" as="script"><link rel="prefetch" href="/blog/assets/introduction.html-BVp0khue.js" as="script"><link rel="prefetch" href="/blog/assets/springboot-mybatis-h2.html-CI6LCygj.js" as="script"><link rel="prefetch" href="/blog/assets/springboot-redis.html-ClhIIeJo.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9i1KJFDr.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-sujHD3Td.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-HzCPwgOt.js" as="script"><link rel="prefetch" href="/blog/assets/demo-sysy.html-B7V8jxoG.js" as="script"><link rel="prefetch" href="/blog/assets/RBAC.html-CLkjcpE7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DOmCISWX.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-C4O0r10Z.js" as="script"><link rel="prefetch" href="/blog/assets/provider-swagger.html-BVdyd51E.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BhlFLpj8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CCrFPR_n.js" as="script"><link rel="prefetch" href="/blog/assets/vcs-git.html-NvlBOzJM.js" as="script"><link rel="prefetch" href="/blog/assets/DBeaver.html-BGEXcyEU.js" as="script"><link rel="prefetch" href="/blog/assets/DbSchema.html-C64sbTkZ.js" as="script"><link rel="prefetch" href="/blog/assets/DrawDB.html-DxIco_1q.js" as="script"><link rel="prefetch" href="/blog/assets/HeidiSQL.html-0Di3ijlk.js" as="script"><link rel="prefetch" href="/blog/assets/Navicat.html-CLRjST3G.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-D4sqgBgu.js" as="script"><link rel="prefetch" href="/blog/assets/datagrip.html-DpdBMgqL.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CwF1W8bD.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-UvFAMdOK.js" as="script"><link rel="prefetch" href="/blog/assets/introduction.html-BIKBhCAO.js" as="script"><link rel="prefetch" href="/blog/assets/email.html-Bo5X0KE7.js" as="script"><link rel="prefetch" href="/blog/assets/gpg.html-DQ0KiKK7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Dpaf32Hb.js" as="script"><link rel="prefetch" href="/blog/assets/idea-plugin.html-DJ9tiF5V.js" as="script"><link rel="prefetch" href="/blog/assets/idea-usage.html-BrArFnP8.js" as="script"><link rel="prefetch" href="/blog/assets/burpsuite.html-BspT_sqI.js" as="script"><link rel="prefetch" href="/blog/assets/404.html-Bm3FNQJ2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DIniEOf6.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CkdkyyQL.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Czt28hV4.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DGQ-tYRt.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-GGUWrNIc.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CMQzxKT8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BTUFqBhI.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BpzwiMqh.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-sX_kYhme.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BLxxN17q.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-nnNMRen2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-D4kLWdpA.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BEm32DAo.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Bq8MAf6H.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BQt7Xnuv.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-HMSQQpOO.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-B7ud57NT.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DqI3np2n.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-COtp4mgy.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BZgLEQKL.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ySKKMDMq.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-_JBcUQfQ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CNF6lvHe.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CCZdNknf.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-B40uOSWl.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-C40Ghv5g.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DgkCEn_f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DyCBNxnX.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CunKy1rP.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DtvTKNAp.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-B0kHd17a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-C34ooXAt.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CuNEvJSZ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-D0StB4pW.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DPT6hZ5y.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-D586cQbp.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BBfSHJL9.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-jp0uHSXa.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BPMWXwaK.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-B_4HJkIy.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BFToQxjI.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CtC3KldB.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BIk0ma1F.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BoO9b2xJ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-D0bt1LAJ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DwKmisYj.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-SRgRlrLK.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-yYVWfT9I.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CHrGMRhp.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CLcpHCAi.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BOCX80gX.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DGUQWQEH.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BATiEmwW.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CAKXgmyN.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-aOeNL21f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BSJ2YySR.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-EtzzvRva.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Becpnfbv.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DqWYUM23.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CbY4Ifkm.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Dq3JB0mN.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DLKBHXGs.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Dn-EBRrj.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-By85cKy-.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-7yiVgiK6.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-B-Z72n3q.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BD1UmhmK.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DBZgpP5c.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DPT6hZ5y.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-C43CQDlr.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DIraAONX.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-vjIuF1bC.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CkbK3gKN.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DwJ1Wu28.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-IlxJZBo5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BLfVCwcZ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CQM-msIk.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-JZU7DLeD.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CXWEhfLA.js" as="script"><link rel="prefetch" href="/blog/assets/flowchart-CTwbLKUk.js" as="script"><link rel="prefetch" href="/blog/assets/index-CSnLIFBj.js" as="script"><link rel="prefetch" href="/blog/assets/index-2riPsTqy.js" as="script"><link rel="prefetch" href="/blog/assets/index-CYbLwmKS.js" as="script"><link rel="prefetch" href="/blog/assets/mermaid.esm.min-Du_Gm6oV.js" as="script"><link rel="prefetch" href="/blog/assets/photoswipe.esm-D2Nf-uDI.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><!--[--><div class="theme-container external-link-icon pure has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/blog/zh/" aria-label="带我回家"><img class="vp-nav-logo" src="/blog/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">个人博客</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/zh/" aria-label="主页"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->主页<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/zh/router.html" aria-label="目录"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><!--]-->目录<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/zh/star/" aria-label="星标"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><!--]-->星标<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/zh/category/" aria-label="分类"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-category" style=""></span><!--]-->分类<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/zh/tag/" aria-label="标签"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-tag" style=""></span><!--]-->标签<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/blog/zh/timeline/" aria-label="时间轴"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-timeline" style=""></span><!--]-->时间轴<!----></a></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/LawssssCat/blog" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/blog/zh/dev-c-commonsense/" aria-label="C/C++ 开发"><!---->C/C++ 开发<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/blog/zh/dev-c-commonsense/basic-syntax.html" aria-label="C/C++基础语法"><!---->C/C++基础语法<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/blog/zh/dev-c-commonsense/gcc.html" aria-label="GCC 使用笔记"><!---->GCC 使用笔记<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/blog/zh/dev-c-commonsense/vcpkg.html" aria-label="vcpkg 使用笔记"><!---->vcpkg 使用笔记<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/blog/zh/dev-c-commonsense/makefile.html" aria-label="Makefile 使用笔记"><!---->Makefile 使用笔记<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/blog/zh/dev-c-commonsense/mingw.html" aria-label="MinGW 使用笔记"><!---->MinGW 使用笔记<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/blog/zh/dev-c-commonsense/msvc.html" aria-label="msvc 使用笔记"><!---->msvc 使用笔记<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/blog/zh/dev-c-commonsense/cmake.html" aria-label="cmake 使用笔记"><!---->cmake 使用笔记<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/blog/zh/dev-c-commonsense/gdb.html" aria-label="GDB 使用笔记"><!---->GDB 使用笔记<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/blog/zh/dev-c-commonsense/posix.html" aria-label="POSIX 使用笔记"><!---->POSIX 使用笔记<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">glibc 使用笔记</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">gtest 使用笔记</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">LLVM 使用笔记</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">openssl 使用笔记</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Perl 使用笔记</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Poco 使用笔记</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!----></aside><!--[--><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->GCC 使用笔记</h1><div class="page-info"><span class="page-author-info" aria-label="作者"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/LawssssCat/" target="_blank" rel="noopener noreferrer">Steven</a></span><span property="author" content="Steven"></span></span><!----><span class="page-date-info" aria-label="写作日期"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2025年9月21日</span><meta property="datePublished" content="2025-09-21T10:59:34.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 19 分钟</span><meta property="timeRequired" content="PT19M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc" vp-toc><!----><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#基础概念">基础概念</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#常见文件、软件">常见文件、软件</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#常见命令">常见命令</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#编译过程">编译过程</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level4" href="#制作可执行文件">制作可执行文件</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level4" href="#制作库文件">制作库文件</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level4" href="#文件后缀">文件后缀</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level4" href="#常用编译选项">常用编译选项</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level4" href="#查看elk信息">查看ELK信息</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#头文件">头文件</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#configure">configure</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#pkg-config-链接库配置生成器">pkg-config 链接库配置生成器</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#title-dynamic-link">动态链接</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level4" href="#动态链接器-dynamic-linker-loader">动态链接器（dynamic linker/loader）</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level4" href="#运行时库的连接-ld-library-path">运行时库的连接 LD_LIBRARY_PATH</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#静态编译">静态编译</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#交叉编译">交叉编译</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#编译原理">编译原理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#安全加固">安全加固</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content" vp-content><p>GCC（GNU Compiler Collection，GNU编译程序集合）是GNU项目的一个开放源码产品。 GCC是一套编译器工具集，支持多种编程语言，包括C、C++、Objective-C、Fortran、Ada、Go和D等。如Python就是由C语言开发，由GNU编译程序编译的！</p><p>GCC官网地址： <a href="https://gcc.gnu.org/" target="_blank" rel="noopener noreferrer">https://gcc.gnu.org/</a> <br> GCC官方文档： <a href="https://gcc.gnu.org/onlinedocs/" target="_blank" rel="noopener noreferrer">https://gcc.gnu.org/onlinedocs/</a></p><!-- more --><p>参考：</p><ul><li>[x] B站|李呵欠|GNU Makefile编译C/C++教程（Linux系统、VSCODE） - <a href="https://www.bilibili.com/video/BV1EM41177s1/" target="_blank" rel="noopener noreferrer">https://www.bilibili.com/video/BV1EM41177s1/</a><br> 配套文档 - <a href="https://github.com/WohimLee/GNC-Tutorial" target="_blank" rel="noopener noreferrer">https://github.com/WohimLee/GNC-Tutorial</a></li></ul><h2 id="基础概念" tabindex="-1"><a class="header-anchor" href="#基础概念"><span>基础概念</span></a></h2><h3 id="常见文件、软件" tabindex="-1"><a class="header-anchor" href="#常见文件、软件"><span>常见文件、软件</span></a></h3><p>项目常见组成部分：</p><table><thead><tr><th>模块</th><th>说明</th><th>备注</th></tr></thead><tbody><tr><td><code>configure</code></td><td>GCC源码树根目录中的一个脚本，用于设置配置值和创建GCC编译程序必须的make程序文件。</td><td> </td></tr><tr><td><code>gcc</code></td><td>该驱动程序等同于执行编译程序和链接程序以产生需要的输出。</td><td>只能编译c语言</td></tr><tr><td><code>c++</code></td><td>gcc的一个版本，默认语言为C++，而且在链接的时候自动包含标准C++库，这和g++一样。</td><td> </td></tr><tr><td><code>g++</code></td><td>gcc的一个版本，默认语言为G++，而且在链接的时候自动包含标准C++库，这和c++一样。</td><td>向下兼容，同时能编译C/C++语言 <br> （<span style="background:yellow;">一般选择此作为编译工具</span>）</td></tr><tr><td><code>libgcc</code></td><td>该库包含的例程段被作为编译程序的一部分，是因为它们可以被链接到实际的可执行程序中。它们是例程，链接到可执行程序，来执行基本的任务，例如浮点运算。这些库中的例程通常都是平台相关的。</td><td> </td></tr><tr><td><code>libstdc++</code></td><td>运行时库，包括定义为标准语言一部分的所有的C++类和函数。</td><td> </td></tr></tbody></table><p>编译常见软件：</p><table><thead><tr><th>工具</th><th>说明</th><th>备注</th></tr></thead><tbody><tr><td><code>ar</code></td><td>这是一个程序，可通过文档添加、删除和析取文件来维护库文件。通常使用该文件是为了创建和管理链接程序使用的目标库文档。该程序是binutils包的一部分。</td><td>编译静态库是用到 e.g. <code>ar rcs libcomplex.a complex.o</code></td></tr><tr><td><code>as</code></td><td>GNU汇编器。实际上它是一族汇编器，因为它可以被编译或者能够在各种不同平台上工作。该程序是binutils包的一部分。</td><td>简单说：将C/C++源文件转换成汇编语言</td></tr><tr><td><code>autoconf</code></td><td>产生的shell脚本自动配置源代码包取编译某个特定版本的UNIX。</td><td> </td></tr><tr><td><code>gdb</code></td><td>GNU调试器。可用于检查程序运行时的值和行为。</td><td>各种IDE（vscode/visualstudio/...）底层调用该工具</td></tr><tr><td>GNATS（GNU Bug Tracking System）</td><td>一个跟踪GCC和其他GNU程序问题的在线系统。</td><td>经常在别人工程中下载库编译安装时经常看到这东西</td></tr><tr><td><code>gprof</code></td><td>该程序会监督编译程序的执行过程，并报告程序中各个函数的运行时间，可以根据所提供的配置车文件来优化程序。该程序是binutils包的一部分。</td><td>静态库/动态库都用到 <br> 新手经常碰到的问题大概率与此库相关，如 ld error ...</td></tr><tr><td><code>ld</code></td><td>GNU连接程序。该程序将目标文件的集合组成可执行程序。该程序是binutils包的一部分。</td><td> </td></tr><tr><td><code>libtool</code></td><td>一个基本库，支持make程序的描述文件使用的简化共享库用法的脚本。</td><td> </td></tr><tr><td><code>make</code></td><td>一个工具程序，它会读makefile脚本来确定程序中哪部分需要编译和连接，然后发布必要的命令。它读出的脚本（makefile或Makefile）定义了文件关系和依赖关系。</td><td>make工具的支持库</td></tr></tbody></table><h3 id="常见命令" tabindex="-1"><a class="header-anchor" href="#常见命令"><span>常见命令</span></a></h3><ul><li><p><code>-B &lt;directory&gt;</code> 将目录添加到编译器的搜索路径</p></li><li><p><code>-v</code> 显示编译器调用的程序</p></li><li><p><code>-E</code> 仅进行预处理（不要编译、汇编或链接）</p></li><li><p><code>-S</code> 仅进行编译（不要汇编或链接）</p></li><li><p><code>-c</code> 仅进行编译和汇编（不要链接）</p></li><li><p><code>-o &lt;file&gt;</code> 指定输出文件路径和名称</p></li><li><p><code>-pie</code> 创建一个动态链接位置无关的可执行文件</p></li><li><p><code>-I</code> 指定“头文件”的包含路径</p></li><li><p><code>-L</code> 指定“链接库”的包含路径</p></li><li><p><code>-shared</code> 创建共享库/动态库</p></li><li><p><code>-static</code> 使用静态链接</p></li><li><p><code>--help</code></p></li><li><p><code>--version</code></p></li></ul><h3 id="编译过程" tabindex="-1"><a class="header-anchor" href="#编译过程"><span>编译过程</span></a></h3><p>简单来说：首先把源代码编译成目标文件， 然后把目标文件链接起来。</p><h4>制作可执行文件</h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">↓</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">↓</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hello.c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> （源文件，文本）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">↓</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">预处理器（cpp）</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ——</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 注释、宏定义展开与处理</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ——</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> e.g.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gcc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -E</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hello.c</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hello.i</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">↓</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">↓</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hello.i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> （修改了的源程序，文本）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">↓</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">编译器（ccl）</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ——</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 生成汇编代码</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ——</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> e.g.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gcc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -S</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hello.c</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hello.s</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">↓</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">↓</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hello.s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> （汇编程序，文本）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">↓</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">汇编器（as）</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ——</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 生成机器码</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ——</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> e.g.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gcc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hello.c</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hello.o</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">↓</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">↓</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hello.o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> （目标程序，二进制）（可重定位程序，relocatable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> object</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> program）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">↓</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">链接器（ld）</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ——</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 找到数据和函数存储位置</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ——</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> e.g.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gcc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hello.c</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hello</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">↓</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">↓</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ←←←</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prinf.o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> （链接二进制）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">↓</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">↓</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hello</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> （目标程序，二进制）（可执行文件）</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4>制作库文件</h4><div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><button type="button" class="vp-tab-nav active" role="tab" aria-controls="tab-311-0" aria-selected="true">制作静态库</button><button type="button" class="vp-tab-nav" role="tab" aria-controls="tab-311-1" aria-selected="false">制作动态库</button></div><!--[--><div class="vp-tab active" id="tab-311-0" role="tabpanel" aria-expanded="true"><div class="vp-tab-title">制作静态库</div><!--[--><p>静态库（static library）是在链接可执行文件时，代码段和数据段直接拷贝到可执行文件中，以便代码复用。</p><p>制作：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># gcc -c lib1.c lib2.c ...</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># gcc -c add.c -o add.o</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># gcc -c tfunc.c -o tfunc.o</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gcc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> add.c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tfunc.c</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 库文件命名规范 lib&lt;库名&gt;.a</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -r</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> liboperation.a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> add.o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tfunc.o</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>链接：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># gcc [.c] [.a] -o [.o]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># gcc [.c] -o [.o] -l[库名] -L[库路径]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gcc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> calc.c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> liboperation.a</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> calc</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 也可以直接使用.o文件链接</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gcc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> calc.o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tfunc.o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> add.o</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> calc</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-tab" id="tab-311-1" role="tabpanel" aria-expanded="false"><div class="vp-tab-title">制作动态库</div><!--[--><blockquote><p>动态链接的具体用法参考： <a href="#title-dynamic-link">here</a></p></blockquote><p>动态库（shared library）是在业务运行时才从文件系统中加载到运行环境中的，因此无法在编译和链接阶段获取代码段的符号地址（代码段的符号包括引用的全局数据，调用的函数等）。</p><blockquote><p>动态链接执行复杂，执行时间比静态链接长。 但是，极大的节省了 size。 其中用到的 PIC 和动态链接技术是计算机发展史上非常重要的一个里程碑。</p></blockquote><p>制作：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># gcc -c -fpic [.c/.cpp] [.c/.cpp] ...</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -fpic/-fPIC</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#       PIC（position independent code）</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#       -fPIC 与生成动态链接可以说没有直接关系，不用fPIC依然可以编译出so文件。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#       但是如果不加 -fPIC 则加载 .so 文件的代码段时，代码段引用的数据对象需要重定位。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#       重定位会修改代码段的内容，这就造成每个使用这个 .so 文件代码段的进程在内核里都会生成这个 .so 文件代码段的copy。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#       由于于这个 .so 文件代码段和数据段内存映射的位置不一样，每个copy都不一样。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#       💡一般用fPIC来生成so，而生成a时则不用fPIC</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#       不使用fPIC编译so的情况：（满足以下4个条件）</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#       1. 该库可能需要经常更新</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#       2. 该库需要非常高的效率（尤其是有很多全局量的使用时）</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#       3. 该库并不很大</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#       4. 该库基本不需要被多个应用程序共享</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gcc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -c</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -fpic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tfunc.c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> add.c</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># gcc -shared [.o] [.o] ... -o [lib库名.so]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -shared —— 生成共享目标文件。通常用在建立共享库时。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#            💡是否添加 -fPIC 的问题：</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#            从GCC来看，shared应该是包含fPIC选项的，但似乎不是所以系统都支持，所以最好显式加上fPIC选项。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gcc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -shared</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tfunc.o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> add.o</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> liboperation.so</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>链接：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># gcc [.c/.cpp] -o [可执行文件名] -l[库名] -L[库路径] -Wl,-rpath=[库路径]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -Wl.option —— 此选项传递option给链接</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#               多个option中间用逗号&quot;,&quot;分割</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -rpath              —— 运行时动态库路径</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -l[库名] -L[库路径]  —— 编译时动态库路径</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gcc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> calc.c</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> calc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -loperation</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -L$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">pwd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">)</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Wl,-rpath=$(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">pwd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container info"><p class="hint-container-title">相关信息</p><p>注意：动态库在Windows和Linux上有区别</p><ul><li>Linux 的搜索路径如下： <ul><li><code>LD_LIBRARY_PATH</code>环境变量中的目录</li><li>系统共享库目录（通常是<code>/lib</code>或者<code>/lib64</code>）</li><li>系统库目录，如<code>/usr/lib</code>、<code>/usr/lib64</code>等</li><li><code>RPATH</code>、<code>RUNPATH</code>指定的路径</li></ul></li><li>Windows 的搜索路径如下： <ul><li>进程的可执行文件所在的目录</li><li>当前目录</li><li>System32目录</li><li>Windows目录</li><li><code>PATH</code>环境变量中的目录</li></ul></li></ul></div><!--]--></div><!--]--></div><h4>文件后缀</h4><div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><button type="button" class="vp-tab-nav active" role="tab" aria-controls="tab-418-0" aria-selected="true">C语言</button><button type="button" class="vp-tab-nav" role="tab" aria-controls="tab-418-1" aria-selected="false">C++语言</button></div><!--[--><div class="vp-tab active" id="tab-418-0" role="tabpanel" aria-expanded="true"><div class="vp-tab-title">C语言</div><!--[--><table><thead><tr><th>后缀（Suffix）</th><th>说明（File Contains）</th></tr></thead><tbody><tr><td><code>.c</code></td><td>源文件 <br> C source code that is to be preprocessed.</td></tr><tr><td><code>.h</code></td><td>头文件 <br> C or C++ header file.</td></tr><tr><td><code>.i</code></td><td>预处理文件 <br> C source code that is not to be preprocessed. <br> This type of file is produced as an intermediate step in compilation.</td></tr><tr><td><code>.s</code></td><td>汇编语言文件 <br> Assembly language code. <br> this type of file is produced as an intermediate step in compilation.</td></tr><tr><td><code>.o</code></td><td>目标文件 <br> An object file in a format appropriate to be supplied to the linker. <br> This type of file is produced as an intermediate step in compilation.</td></tr><tr><td><code>.a</code></td><td>静态库文件 <br> Static object library (archive).</td></tr><tr><td><code>.so</code> <br><code>.lib</code>/<code>.dll</code> (for windows)</td><td>动态库/共享库/运行时库文件 <br> Shared object library.</td></tr></tbody></table><!--]--></div><div class="vp-tab" id="tab-418-1" role="tabpanel" aria-expanded="false"><div class="vp-tab-title">C++语言</div><!--[--><table><thead><tr><th>后缀（Suffix）</th><th>说明（File Contains）</th></tr></thead><tbody><tr><td><code>.C</code>/<code>.c++</code>/<code>.cc</code>/<code>.cp</code>/<code>.cpp</code>/<code>.cxx</code></td><td>源文件 <br> C++ source code that is to be preprocessed.</td></tr><tr><td><code>.h</code></td><td>头文件 <br> C or C++ header file.</td></tr><tr><td><code>&lt;none&gt;</code></td><td>The standard C++ system header files have no suffix</td></tr><tr><td><code>.ii</code></td><td>预处理文件 <br> C++ source code that is not to be preprocessed. <br> This type of file is produced as an intermediate step in compilation.</td></tr><tr><td><code>.s</code></td><td>汇编语言文件 <br> Assembly language code. <br> this type of file is produced as an intermediate step in compilation.</td></tr><tr><td><code>.o</code></td><td>目标文件 <br> An object file in a format appropriate to be supplied to the linker. <br> This type of file is produced as an intermediate step in compilation.</td></tr><tr><td><code>.a</code></td><td>静态库文件 <br> Static object library (archive).</td></tr><tr><td><code>.so</code> <br><code>.lib</code>/<code>.dll</code> (for windows)</td><td>动态库/共享库/运行时库文件 <br> Shared object library.</td></tr></tbody></table><!--]--></div><!--]--></div><h4>常用编译选项</h4><table><thead><tr><th>编译选项</th><th>说明</th><th>备注</th></tr></thead><tbody><tr><td><code>-m64</code></td><td>指定编译为64位应用</td><td> </td></tr><tr><td><code>-std=</code></td><td>指定编译标准，例如： <code>-std=c++11</code>/<code>-std=c++14</code></td><td> </td></tr><tr><td><code>-g</code></td><td>包含调试信息</td><td> </td></tr><tr><td><code>-w</code></td><td>不显示告警</td><td> </td></tr><tr><td><code>-O</code></td><td>优化等级，通常使用 <code>-O3</code></td><td> </td></tr><tr><td><code>-I</code></td><td>加载头文件路径前</td><td> </td></tr><tr><td><code>-fPIC</code> <br> （Position-Independent Code）</td><td>产生二进制文件没有绝对地址，使用全部相对地址。二进制可以被加载到内存任意位置，且可以正确的执行</td><td>共享库必加</td></tr></tbody></table><table><thead><tr><th>链接选项</th><th>说明</th><th>备注</th></tr></thead><tbody><tr><td><code>-l</code></td><td>加在库名前面</td><td> </td></tr><tr><td><code>-L</code></td><td>加在库路径前面</td><td> </td></tr><tr><td><code>-Wl,&lt;选项&gt;</code></td><td>将<code>&lt;选项&gt;</code>传递给链接器</td><td> </td></tr><tr><td><code>-Wl,-rpath=&quot;共享库路径&quot;</code></td><td>指定运行时共享库（.so文件）路径所在的目录</td><td> </td></tr></tbody></table><h4>查看ELK信息</h4><p>Linux的可执行文件一般是elf格式（Executable and Linking Format，可执行可连接格式）的，在这个可执行文件的头部包含了很多重要的信息：如文件格式，加载地址，符号表等。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">####################################</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 命令： file &lt;some-file&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">####################################</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hello.o</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hello.o:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ELF</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 64-bit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> LSB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> relocatable,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> x86-64,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> version</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (SYSV), not stripped</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ELF ——————————————— 💡Executable and Linking Format，可执行可连接格式</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 64-bit</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># LSB ——————————————— 💡Least Significant Bit，最小标识位/最低位有效。表示时是小端模式的程序</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># relocatable ——————— 💡可重定位，运行时才指定内存位置？</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># x86-64 ———————————— 💡cpu架构</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># version 1 (SYSV) —— 💡System V | 程序初始化方案？</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># stripped/not stripped </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#   + stripped     —— 💡将程序中的符号表的信息剔除掉了，优点： 1. 可执行文件体积减少； 2. 程序更难以被调试/逆向/破解</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#   + not stripped —— 💡保留了上述信息，便于调试</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">####################################</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 命令： readelf -h &lt;elk-file&gt; —— 💡查看二进制文件头文件</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">####################################</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> readelf</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -h</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hello.o</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ELF</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Header:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Magic:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   7f</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 45</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 4c</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 46</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 02</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 01</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 01</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Class:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                             ELF64</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Data:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">                              2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;s complement, little endian</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Version:                           1 (current)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  OS/ABI:                            UNIX - System V</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  ABI Version:                       0</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Type:                              REL (Relocatable file) # ———————— 💡文件类型 ❗可重定位，运行时才指定内存位置？</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Machine:                           Advanced Micro Devices X86-64 # — 💡适配的cpu架构</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Version:                           0x1</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Entry point address:               0x0 # ——————————————————————————— 💡程序入口地址 ❗无指定</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Start of program headers:          0 (bytes into file)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Start of section headers:          616 (bytes into file)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Flags:                             0x0</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Size of this header:               64 (bytes)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Size of program headers:           0 (bytes)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Number of program headers:         0</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Size of section headers:           64 (bytes)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Number of section headers:         14</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Section header string table index: 13</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$ ./hello.o # 未可执行</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">-bash: ./hello.o: cannot execute binary file: Exec format error</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="头文件" tabindex="-1"><a class="header-anchor" href="#头文件"><span>头文件</span></a></h3><p>C/C++ 中 <code>#include</code> 头文件有两种形式，一种是使用尖括号<code>&lt;&gt;</code>，一种是使用双引号<code>&quot;&quot;</code>。</p><ul><li><code>#include</code>/<code>#define</code>/<code>#if</code> 为预处理语句 —— 宏，由预处理器处理 <ul><li><code>#include</code> 用于在编译前将指定的头文件内容插入到源文件中</li></ul></li><li><code>#include &quot;xxx.h&quot;</code> 适合用于指定<strong>项目内部或者开发者本地自定义的头文件</strong>路径 查找顺序： <ol><li>当前文件所在的目录 —— 编译器首先查找与当前源文件同目录的头文件。</li><li>引用该文件的的文件夹 —— 如果该源文件被其他文件通过<code>#include</code>引用，编译器会在最先引用该文件的文件夹内查找。</li><li>指定的项目包路径 —— 略</li><li>全局或系统路径 —— 略</li></ol></li><li><code>#include &lt;xxx.h&gt;</code> 仅在全局或系统或者指定的项目包路径中查找这些头文件，<strong>忽略当前目录，且优先级顺序不同</strong>。 这是为了更高效地查找<strong>标准库和第三方库</strong>中的头文件。（当然也便于读代码时候区分是软件自身的代码还是三方依赖的代码） 查找顺序： <ol><li>C++标准库路径 —— 即如<code>/usr/lib64/libstdc++.so.6</code>等路径。 这些路径可能包含<code>&lt;iostream&gt;</code>/<code>&lt;vector&gt;</code>/<code>&lt;string&gt;</code>等标准库文件。</li><li>系统库路径 —— 这些路径通常是操作系统或者IDE预先配置好的系统路径。 在Linux系统中常见为<code>/usr/include</code>,<code>/usr/local/include</code>等路径（环境变量：<code>LD_LIBRARY_PATH</code>）； 在Windows系统中可能是<code>C:\Program Files (x86)\Microsoft Visual Studio\</code>路径。</li><li>指定的项目包路径 —— 通过编译器参数指定的路径，如<code>-I /path/to/include</code>选项（环境变量：<code>CPLUS_INCLUDE_PATH</code>）。 这个路径可以是多个目录，依赖于构建系统的设置。 这些路径一般存有开发者指定的第三方库的头文件，例如Boost、Poco、QT等。 <ul><li>GCC/Clang: <code>g++ -I /path/to/headers main.cpp</code></li><li>CMake: <code>include_directories()</code>/<code>target_include_directories()</code></li></ul></li></ol></li></ul><div class="hint-container tip"><p class="hint-container-title">提示</p><p>可以通过命令 <code>echo | gcc -x c -v -E -</code> 查看具体的搜索路径</p><div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><button type="button" class="vp-tab-nav active" role="tab" aria-controls="tab-822-0" aria-selected="true">C++编译器（GCC）</button><button type="button" class="vp-tab-nav" role="tab" aria-controls="tab-822-1" aria-selected="false">C++编译器（Clang）</button></div><!--[--><div class="vp-tab active" id="tab-822-0" role="tabpanel" aria-expanded="true"><div class="vp-tab-title">C++编译器（GCC）</div><!--[--><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># gcc：表示使用GCC编译器进行编译。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -x c++：表示指定编译的语言为C++。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -v：表示显示详细的编译过程信息。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -E：表示仅执行预处理阶段，不进行编译和链接。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -：表示从标准输入读取源代码。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> echo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gcc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> c++</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -E</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ignoring</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nonexistent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> directory</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;/usr/lib/gcc/x86_64-redhat-linux/15/include-fixed&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ignoring</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nonexistent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> directory</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;/usr/lib/gcc/x86_64-redhat-linux/15/../../../../x86_64-redhat-linux/include&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#include &quot;...&quot; search starts here:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#include &lt;...&gt; search starts here:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> /usr/lib/gcc/x86_64-redhat-linux/15/../../../../include/c++/15</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> /usr/lib/gcc/x86_64-redhat-linux/15/../../../../include/c++/15/x86_64-redhat-linux</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> /usr/lib/gcc/x86_64-redhat-linux/15/../../../../include/c++/15/backward</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> /usr/lib/gcc/x86_64-redhat-linux/15/include</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> /usr/local/include</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> /usr/include</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-tab" id="tab-822-1" role="tabpanel" aria-expanded="false"><div class="vp-tab-title">C++编译器（Clang）</div><!--[--><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># clang：表示使用GCC编译器进行编译。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -x c++：表示指定编译的语言为C++。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -v：表示显示详细的编译过程信息。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -E：表示仅执行预处理阶段，不进行编译和链接。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -：表示从标准输入读取源代码。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> echo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">clang</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> c++</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -E</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div></div><blockquote><p>总结：</p><ul><li><code>#include &lt;...&gt;</code> 优先查找标准库和外部库文件，用于引用系统文件和第三方库等开发者一般不可修改的头文件。</li><li><code>#include &quot;...&quot;</code> 优先查找开发者本地文件，用于引用开发团队项目内部或者开发者本地定义的，开发者可以修改的头文件。</li></ul></blockquote><h3 id="configure" tabindex="-1"><a class="header-anchor" href="#configure"><span>configure</span></a></h3><p><code>configure</code> 是一个脚本文件，定义了执行时可以传入的必要参数，告知配置项目。 <code>configure</code> 程序它会根据传入的配置项目检查程序编译时所依赖的环境以及对程序编译安装进行配置，最终生成编译所需的 <code>Makefile</code> 文件供程序 <code>make</code> 读入使用进而调用相关编译程式来编译最终的二进制程序。</p><p>参考：</p><ul><li>简述configure、pkg-config、pkg_config_path三者的关系 | <a href="https://www.cnblogs.com/wliangde/p/3807532.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/wliangde/p/3807532.html</a></li></ul><h3 id="pkg-config-链接库配置生成器" tabindex="-1"><a class="header-anchor" href="#pkg-config-链接库配置生成器"><span>pkg-config 链接库配置生成器</span></a></h3><p>而configure脚本在检查相应依赖环境时(例：所依赖软件的版本、相应库版本等)，通常会通过pkg-config的工具来检测相应依赖环境。</p><p>一般来说，如果库的头文件不在 <code>/usr/include</code> 目录中，那么在编译的时候需要用 <code>-I</code> 参数指定其路径。 但由于编译的环境和编译后程序运行的环境大概率不同，通过 <code>-I</code> 指定的文件路径大概率也不一样，这是需要编译后的 <code>lib/pkgconfig</code> 目录中添加 <code>.pc</code> 文件来指定库的各种必要信息，包括版本信息、编译和连接需要的参数等。 这样，不管库文件安装在哪，通过库对应的 <code>.pc</code> 文件就可以准确定位，可以使用相同的编译和连接命令，使得编译和连接界面统一。</p><div class="language-txt line-numbers-mode" data-highlighter="shiki" data-ext="txt" data-title="txt" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>prefix=/opt/gtk/</span></span>
<span class="line"><span>exec_prefix=${prefix}</span></span>
<span class="line"><span>libdir=${exec_prefix}/lib</span></span>
<span class="line"><span>includedir=${prefix}/include</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>glib_genmarshal=glib-genmarshal</span></span>
<span class="line"><span>gobject_query=gobject-query</span></span>
<span class="line"><span>glib_mkenums=glib-mkenums</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>Name: GLib</span></span>
<span class="line"><span>Description: C Utility Library</span></span>
<span class="line"><span>Version: 2.12.13</span></span>
<span class="line"><span>Libs: -L${libdir} -lglib-2.0</span></span>
<span class="line"><span>Cflags: -I${includedir}/glib-2.0 -I${libdir}/glib-2.0/include</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 列出所有可使用的包</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 位置在：</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># + /usr/lib/pkgconfig —— 此目录下都是各种.pc文件。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># + /usr/local/lib/pkgconfig —— 新软件一般都会安装.pc文件</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># + 没有可以自己创建，并且设置环境变量 PKG_CONFIG_PATH 寻找 .pc 文件路径。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pkg-config</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> –-list-all</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 给出在编译时所需要的选项</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gcc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> `</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pkg-config</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --cflags</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> glib-2.0`</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> sample.c</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 给出连接时的选项</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gcc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sample.o</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sample</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> `</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pkg-config</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --libs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> glib-2.0`</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> PKG_CONFIG_PATH</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">opt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">gtk</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">lib</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">pkgconfig</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$PKG_CONFIG_PATH</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> LD_LIBRARY_PATH</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">opt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">gtk</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">lib</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$LD_LIBRARY_PATH</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="title-dynamic-link" tabindex="-1"><a class="header-anchor" href="#title-dynamic-link"><span>动态链接</span></a></h3><p>Linux支持动态连接库，不仅节省了磁盘、内存空间，而且可以提高程序运行效率。不过引入动态连接库也可能会带来很多问题，例如动态连接库的调试、升级更新和潜在的安全威胁。</p><blockquote><p>参考：</p><ul><li>动态符号链接的细节 - <a href="https://www.w3cschool.cn/cbook/ojay2ozt.html" target="_blank" rel="noopener noreferrer">https://www.w3cschool.cn/cbook/ojay2ozt.html</a> 【非常详细】</li></ul></blockquote><p>为了让动态链接器能够进行符号的重定位，必须把动态链接库的相关信息写入到可执行文件当中：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 通过 readelf -d 可以打印出该文件直接依赖的库</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> readelf</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> NEEDED</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> 0x00000001</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (NEEDED)                     Shared library: [libc.so.6]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 通过 ldd 命令则可以打印出所有依赖或者间接依赖的库</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ldd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">      linux-gate.so.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt;  (0xffffe000) </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 在文件系统中并没有对应的库文件，它是一个虚拟的动态链接库，对应进程内存映像的内核部分。参考： http://www.linux010.cn/program/Linux-gateso1-DeHanYi-pcee6103.htm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">      libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/lib/libc.so.6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0xb7da2000)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">      /lib/ld-linux.so.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0xb7efc000) </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 动态链接器 | 绝对路径 | readelf -x .interp test | interpeter</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 程序的加载过程 - 动态链接器</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 当 Shell 解释器或者其他父进程通过exec启动我们的程序时，系统会先为ld-linux创建内存映像，然后把控制权交给ld-linux，</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 之后ld-linux负责为可执行程序提供运行环境，负责解释程序的运行，因此ld-linux也叫做dynamic loader（或intepreter）</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 参考： http://www.ibm.com/developerworks/cn/linux/l-elf/part1/index.html</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>程序有两种方式使用库</p><ul><li>编译时通过 <code>-l</code>,<code>-L</code> 参数隐式使用： <code>gcc -o test test.c -lmyprintf -L./ -I./</code></li><li>运行时通过 <code>LD_LIBRARY_PATH</code> 环境变量显示使用： <code>LD_LIBRARY_PATH=$PWD</code></li></ul><div class="hint-container tip"><p class="hint-container-title">提示</p><p><strong>指定动态库位置</strong>：</p><p>通过 <code>LD_LIBRARY_PATH</code> 参数，它类似 Shell 解释器中用于查找可执行文件的 <code>PATH</code> 环境变量，也是通过冒号分开指定了各个存放库函数的路径。</p><p>该变量实际上也可以通过 <code>/etc/ld.so.conf</code> 文件来指定，一行对应一个路径名。 （一般需要管理员权限） <br> 为了提高查找和加载动态链接库的效率，系统启动后会通过 <code>ldconfig</code> 工具创建一个库的缓存 <code>/etc/ld.so.cache</code>。 如果用户通过 <code>/etc/ld.so.conf</code> 加入了新的库搜索路径或者是把新库加到某个原有的库目录下，最好是执行一下 <code>ldconfig</code> 以便刷新缓存。</p><p>更多参考： <code>man ld-linux</code>, <code>/lib/ld-linux.so.2</code></p></div><h4>动态链接器（dynamic linker/loader）</h4><p>Linux 下 elf 文件的动态链接器是 ld-linux.so，即 <code>/lib/ld-linux.so.2</code>。 通过 <code>man ld-linux</code> 可以获取与动态链接器相关的资料，包括各种相关的环境变量和文件都有详细的说明。</p><p>如：</p><ul><li><p><code>LD_LIBRARY_PATH</code></p></li><li><p><code>LD_BIND_NOW</code></p></li><li><p><code>LD_PRELOAD</code> 指定预装载一些库，以便替换其他库中的函数，从而做一些安全方面的处理</p></li><li><p><code>LD_DEBUG</code> 用来进行动态链接的相关调试</p></li><li><p><code>ld.so.conf</code></p></li><li><p><code>ld.so.cache</code></p></li><li><p><code>/etc/ld.so.preload</code> 指定需要预装载的库</p></li></ul><h4>运行时库的连接 <code>LD_LIBRARY_PATH</code></h4><p>库文件在连接（静态库和共享库）和运行（仅限于使用共享库的程序）时被使用，其搜索路径是在系统中进行设置的。</p><p>一般Linux系统把 <code>/lib</code> 和 <code>/usr/lib</code> 两个目录作为默认的库搜索路径，所以使用这两个目录中的库是不需要进行设置搜索路径即可直接使用。 对于处于默认库搜索路径之外的库，需要将库的位置添加到 库的搜索路径之中。 设置库文件的搜索路径有下列两种方式，可任选其一使用：</p><ol><li>会话生效 —— 在环境变量 <code>LD_LIBRARY_PATH</code> 中指明库的搜索路径。</li></ol><p><code>export LD_LIBRARY_PATH=/opt/gtk/lib:$LD_LIBRARY_PATH</code></p><ol><li>永久生效 —— 在 <code>/etc/ld.so.conf</code> 文件中添加库的搜索路径（绝对路径）。 ⚠️一般需管理员权限</li></ol><p>e.g.</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/X11R6/lib</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/local/lib</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/opt/lib</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>另外，为了加快程序执行时对共享库的定位速度，避免使用搜索路径查找共享库的低效率，会有 <code>/etc/ld.so.cache</code> 库列表文件可以直接读取、搜索。 <code>/etc/ld.so.cache</code> 是一个非文本的数据文件，不能直接编辑，它是根据 <code>/etc/ld.so.conf</code> 中设置的搜索路径由 <code>/sbin/ldconfig</code> 命令将这些搜索路径下的共享库文件集中在一起而生成的( <code>ldconfig</code> 命令要以 root 权限执行)。</p><p>如当安装完一些库文件(例如刚安装好glib)，或者修改 <code>ld.so.conf</code> 增加新的库路径后，需要运行一下 <code>/sbin/ldconfig</code> 使所有的库文件都被缓存到 <code>ld.so.cache</code> 中。 否则 <code>ld.so.conf</code> 的更改不生效。</p></div><h3 id="静态编译" tabindex="-1"><a class="header-anchor" href="#静态编译"><span>静态编译</span></a></h3><p>一般在“裸机”上跑的程序会考虑使用静态链接编译，避免动态链接缺失的情况</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p><strong>Linux 和 裸机（baremetal） 区别</strong>：</p><ul><li>Linux —— 在已安装操作系统的机器上跑。一般：个人pc、公司服务器</li><li>baremetal —— 直接由硬件调起。一般：嵌入式</li></ul></div><p>编译参数：</p><ul><li>gcc —— <code>-static</code></li></ul><div class="hint-container tip"><p class="hint-container-title">提示</p><p>静态编译的二进制通过 <code>ldd</code> 可以看到 &quot;not a dynamic executable&quot; 的字样。 而 <s><code>-nostdlib</code></s> 通过 <code>ldd</code> 看到的是 &quot;statically linked&quot;，这表示 “它恰好没有链接到任何库，但在其他方面与普通 PIE 相同，指定了 ELF 解释器。”</p><p>todo What&#39;s the difference between &quot;statically linked&quot; and &quot;not a dynamic executable&quot; from Linux ldd? | <a href="https://stackoverflow.com/questions/61553723/whats-the-difference-between-statically-linked-and-not-a-dynamic-executable" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/61553723/whats-the-difference-between-statically-linked-and-not-a-dynamic-executable</a></p></div><h3 id="交叉编译" tabindex="-1"><a class="header-anchor" href="#交叉编译"><span>交叉编译</span></a></h3><p>“交叉编译” 指在一个平台上生成另一个平台上的可执行文件。</p><p>一般要用到如下编译工具（todo 各工具作用）</p><ul><li>gcc</li><li>ld</li><li>objcopy</li><li>objdump</li></ul><p>交叉编译工具链</p><ul><li><code>arm-linux-gcc</code></li><li><code>arm-none-linux-gnueabi-gcc-ld</code></li></ul><p>e.g. 交叉编译脚本</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">install_arm32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gcc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gcc-arm-linux-gnueabi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> binutils-arm-linux-gnueabi</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">install_arm64</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gcc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gcc-aarch64-linux-gun</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> binutils-aarch64-linux-gnu</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gen_hello</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">helloworld.c</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">#include&lt;stdio.h&gt;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">int main()</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  printf(&quot;Hello World!\n&quot;);</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  return 0;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">compile_64</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  gcc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> helloworld.c</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> helloworld-x86_64</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">compile_arm32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  arm-linux-gnueabi-gcc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> helloworld.c</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> helloworld-arm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -static</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">compile_arm64</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  aarchi64-linux-gnu-gcc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> helloworld.c</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> helloworld-aarch64</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -static</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Main.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># install_arm32</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># install_arm64</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gen_hello</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">compile_64</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> || </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">exit</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">compile_arm32</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">compile_arm64</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="编译原理" tabindex="-1"><a class="header-anchor" href="#编译原理"><span>编译原理</span></a></h2><p>todo</p><h2 id="安全加固" tabindex="-1"><a class="header-anchor" href="#安全加固"><span>安全加固</span></a></h2><p>todo</p><p><code>nm</code> 可以查看 elf 文件的符号信息</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gcc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test.c</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test.o</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">00000000</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> B</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> global</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">00000000</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> T</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> main</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">          U</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> printf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/LawssssCat/blog/edit/master/src/zh/dev-c-commonsense/gcc.md" aria-label="在 GitHub 上编辑此页" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">上次编辑于: </span><span class="vp-meta-info" data-allow-mismatch="text">2025/10/6 03:09:14</span></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 18041500+LawssssCat@users.noreply.github.com">lawsssscat</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/blog/zh/dev-c-commonsense/basic-syntax.html" aria-label="C/C++基础语法"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->C/C++基础语法</div></a><a class="route-link auto-link next" href="/blog/zh/dev-c-commonsense/vcpkg.html" aria-label="vcpkg 使用笔记"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">vcpkg 使用笔记<!----></div></a></nav><!----><!----><!--]--></main><!--]--><!--]--><footer class="vp-footer-wrapper" vp-footer><!----><div class="vp-copyright">Copyright © 2025 Steven</div></footer></div><!--]--><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/blog/assets/app-DY6veuwS.js" defer></script>
  </body>
</html>
